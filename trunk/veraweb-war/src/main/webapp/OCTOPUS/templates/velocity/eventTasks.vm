#set($activeMenu = "Veranstaltungen")
#set($title = "Aufgaben")
#parse("inc/header.vm")

#set($formurl = "ShowEventTasks")
<div class="contentContainer">
	<form id="formlist" name="formlist" action="$formurl?id=$!id" method="POST">
	
	<input type="hidden" name="start" value="">
	<input type="hidden" name="selectAll" value="false">
	<input type="hidden" name="selectNone" value="false">
	<input type="hidden" name="doRemove" value="true">
	
	
	<table class="tab" border="0" cellspacing="0" cellpadding="0"><tr>
		<td class="tableft">&nbsp;</td>
		<td class="tabinactiv"><a href="ShowEvent?id=$!id" class="tabinactiv">Allgemein</a></td>
		<td class="tabinactiv"><a href="${paths.staticWeb}do/ShowEventDoctype?id=$!id" class="tabinactiv">Dokumenttypen</a></td>
		<td class="tabactiv"><a id="tab.tasks" href="${paths.staticWeb}do/ShowEventTasks?id=$!id" class="tabinactiv">Aufgaben</a></td>
		<td class="tabright">&nbsp;</td>
	</tr></table>
	
	<input type="hidden" id="remove-task" name="remove-task" value="false">
	
	<script language="JavaScript" type="text/javascript">
	<!--
		function removeTask() {
			var task = confirm('Markierte Aufgabe(n) wirklich entfernen?');
			
			document.getElementById('remove-task').value = task;
			return task;
		}
	-->
	</script>
	
	#if(($listerrors && $listerrors.size() > 0) || ($listquestions && $listquestions.size() > 0))
	#set($save = false)
	
	#if($listerrors && $listerrors.size() > 0)
	<div style="margin: 10px 0px 10px 0px; padding: 10px 10px 10px 10px; background-color: #ffffff; border: 2px solid #ff0000;">
		<strong>L&ouml;schen von Aufgaben ist nicht m&ouml;glich:</strong><br>
		<ul style="margin: 0px 0px 0px -10px;">
		#if($listerrors.size() > 5)
		#set($show = 5)
		#else
		#set($show = $listerrors.size())
		#end
		#foreach($error in $listerrors)
		#if($velocityCount <= $show)
			<li style="margin: 5px 0px 0px 0px;">$!message.plain($error)</li>
		#end
		#end
		#if($listerrors.size() > $show)
		#set($drop = $listerrors.size() - $show)
			<li style="margin: 5px 0px 0px 0px;"><em>...  $drop weitere Meldungen.</em></li>
		#end
		</ul>
	</div>
	#end
	#if($listquestions && $listquestions.size() > 0)
	<div style="margin: 10px 0px 10px 0px; padding: 10px 10px 10px 10px; background-color: #ffffff; border: 2px solid #00ff00;">
		<strong>Bitte best&auml;tigen Sie das L&ouml;schen von Aufgaben:</strong><br>
		<ul style="margin: 0px 0px 0px -10px;">
		#foreach($quest in $listquestions.entrySet())
			<li style="margin: 5px 0px 0px 0px;"><input type="hidden" name="$quest.key" value="true">$!message.plain($quest.value)</li>
			#set($save = true)
		#end
		</ul><br>
		#if($save)
		<input type="submit" class="button" name="remove" value="Ja" title="markierte Aufgabe(n) l&ouml;schen"> &nbsp;
		#end
		<input type="button" class="cancel" name="cancel" value="Nein" onclick="window.location.href='ShowEventTasks?id=$!id'"> &nbsp;
	</div>
	#end
	
	#end
	
	#foreach($bean in $list)
	<input type="hidden" name="list" value="$bean.id">
	#end
	
	#if($grants.mayWrite())
		<span>
			<strong>Markierte Aufgaben</strong> <input type="submit" id="remove" name="remove" value="L&ouml;schen" title="Markierte Aufgaben l&ouml;schen"  onclick="return removeTask();">
		</span>
	#end
	
	#if($grants.mayWrite())
		<span class="floatRight">
			<input type="button" id="new" name="new" value="Neue Aufgabe anlegen" title="Neue Aufgabe anlegen" class="mainButton" onclick="window.location.href='CreateEventTask?eventId=$!id';">	
		</span>
	#end
	
	<table>
		<tr class="list1">
			<th class="smallCell textCenter">&nbsp;</th>
			<th class="smallCell textCenter">ID</th>
			<th>Titel</th>
			<th class="smallCell textCenter">Start</th>
			<th class="smallCell textCenter">Ende</th>
			<th class="smallCell textCenter">Status</th>
			<th>Verantwortlicher</th>
			<th class="smallCell textCenter">Priorit&auml;t</th>
		</tr>
	#foreach($bean in $list)	
		#if ($velocityCount % 2 == 0)
			#set($class = "list1")
		#else
			#set($class = "list2")
		#end
		<tr class="$class">
			<td class="textCenter">
				<input type="checkbox" id="add-select" name="${bean.id}-select" value="true" class="checkbox" #if($listselection.indexOf($bean.id) != -1) checked#end>			
			</td>
			<td class="textCenter" style="cursor: pointer;" onclick="window.location.href='ShowEventTask?id=$!{bean.id}&eventId=$!{bean.eventId}'">$!bean.id</td>
			<td style="cursor: pointer;" onclick="window.location.href='ShowEventTask?id=$!{bean.id}&eventId=$!{bean.eventId}'">$!message.plain($!bean.title)</td>
			#if ($bean.startdate.Seconds == 30)
					<td class="textCenter" style="cursor: pointer;" onclick="window.location.href='ShowEventTask?id=$!{bean.id}&eventId=$!{bean.eventId}'">$!message.date("DATE",$bean.startdate)</td>
			#else
					<td class="textCenter" style="cursor: pointer;" onclick="window.location.href='ShowEventTask?id=$!{bean.id}&eventId=$!{bean.eventId}'">$!message.date("DATE_TIME",$bean.startdate) Uhr</td>
			#end
			
			#if ($bean.enddate.Seconds == 30)
					<td class="textCenter" style="cursor: pointer;" onclick="window.location.href='ShowEventTask?id=$!{bean.id}&eventId=$!{bean.eventId}'">$!message.date("DATE",$bean.enddate)</td>
			#else 
					<td class="textCenter" style="cursor: pointer;" onclick="window.location.href='ShowEventTask?id=$!{bean.id}&eventId=$!{bean.eventId}'">$!message.date("DATE_TIME",$bean.enddate) Uhr</td>
			#end
	
			<td class="textCenter" style="cursor: pointer;" onclick="window.location.href='ShowEventTask?id=$!{bean.id}&eventId=$!{bean.eventId}'">$!bean.degreeofcompletion%</td>
			<td style="cursor: pointer;" onclick="window.location.href='ShowEventTask?id=$!{bean.id}&eventId=$!{bean.eventId}'">$!bean.personName</td>
			<td class="textCenter" style="cursor: pointer;" onclick="window.location.href='ShowEventTask?id=$!{bean.id}&eventId=$!{bean.eventId}'">$!bean.priority</td>
		</tr>
	#end
	</table>
	
	#if ($listparam.count == 0)
		<br>Keine Daten gefunden.
	#end

		#parse("inc/list-navi.vm")
		#parse("inc/list-direct.vm")
		
	<div class="textRight">	
		<!--input type="button" id="cancel" name="cancel" class="button" value="Zur&uuml;ck" title="Zur Suche" onclick="window.location.href='SearchEvent';"-->
	</div>
	
	
	</form>
</div>
<script type="text/javascript">
#if(!$grants.mayWrite())
	disableForm(document.getElementById('formlist'));
#end
</script>

#parse("inc/footer.vm")