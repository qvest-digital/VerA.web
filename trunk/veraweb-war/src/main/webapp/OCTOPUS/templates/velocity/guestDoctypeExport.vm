#set($activeMenu = "Veranstaltungen")
#set($title = "Steuerdatei erzeugen f&uuml;r Veranstaltung: $!message.plain($event.shortname)")
#parse("inc/header.vm")

<div id="content_container">
	<div id="breadcrumb" class="textRight marginBottom10">
		<strong>Sie sind hier</strong> <span><a href="${paths.staticWeb}do/" title="Zur Startseite">Home</a> > Personen > <a href="${paths.staticWeb}do/ShowPersonSearch?action=person" title="Zur Personensuche">Personensuche</a> > Suchergebnis</span>
    </div>
    
	<h1>Steuerdatei</h1>
    
    #parse("inc/event-header.vm")
    
    #if($exportCalc)
    
    <form id="ExportForm" action="ShowExportGuestDoctype" method="post">
		
		<h2>Dokumenttyp ausw√§hlen</h2>
		
		<p class="inlineLabel">
			<label for="doctype">Dokumenttyp</label>
			<select name="doctype"  onChange="document.getElementById('ExportForm').action='ShowExportGuestDoctype'; submit();" id="doctype">
    			#foreach($bean in $allEventDoctype)
    			<option value="$!bean.doctype" #if($bean.doctype == $exportCalc.doctype) selected#end>$!bean.name</option>
    			#end
    		</select>
		</p>
    
		<h2>Daten bearbeiten</h2>
		
		<div class="table">
			<div class="tableRow">
				<div class="tableCell">
					<label for="total">Ausgew&auml;hlte G&auml;ste</label>
				</div>
				<div class="tableCell">
					<input type="text" id="total" name="total" value="$!exportCalc.total" class="id" vera-disabled />
				</div>
			</div>
			
			<div class="tableRow">
				<div class="tableCell">
					<label for="available">Exportierf&auml;hige G&auml;ste</label>
				</div>
				<div class="tableCell">
					<input type="text" name="available" id="available" value="$!exportCalc.available" class="id" vera-disabled />					
				</div>
			</div>
    
        	#if($exportCalc.total > $exportCalc.available)
            #set($diff = $exportCalc.total - $exportCalc.available)
        			<div class="tableRow">
        				<div class="tableCell">
        					<label for="diff">Unvollst&auml;ndige G&auml;ste</label>
        				</div>
        				<div class="tableCell">
        					<input type="text" id="diff" name="diff" value="$!diff" class="id" vera-disabled />
        				</div>
        			</div>
            #end
		</div>

    
    <table class="form"><tr>
    	<td class="label" style="width: 19%;">Sortierung:</td>
    	<td class="value">
    		<select name="sort1" >
    #if($search.listorder == "lastname_a_e1" || $search.listorder == "firstname_a_e1" || $search.listorder == "mail_a_e1")
    			<option value="orderno">Laufende Nummer</option>
    			<option value="name" selected>Name</option>
    			<option value="country">Land</option>
    			<option value="zipcode">PLZ</option>
    			<option value="category">Kategorie</option>
    			<option value="rank">Rang</option>
    			<option value="table">Tisch</option>
    ## modified to support workareas as per change request for version 1.2.0
    ## cklein
    ## 2008-02-26
    			<option value="workareaname">Arbeitsbereich</option>
    #else
    			<option value="orderno">Laufende Nummer</option>
    			<option value="name">Name</option>
    			<option value="country">Land</option>
    			<option value="zipcode">PLZ</option>
    			<option value="category">Kategorie</option>
    			<option value="rank">Rang</option>
    			<option value="table">Tisch</option>
    ## modified to support workareas as per change request for version 1.2.0
    ## cklein
    ## 2008-02-26
    			<option value="workareaname">Arbeitsbereich</option>
    #end
    		</select>
    	</td>
    </tr><tr>
    	<td class="label" style="width: 19%;">&nbsp;</td>
    	<td class="value">
    		<select name="sort2" >
    			<option value=""></option>
    #if($search.listorder == "lastname_a_e1" || $search.listorder == "firstname_a_e1" || $search.listorder == "mail_a_e1")
    			<option value="orderno">Laufende Nummer</option>
    			<option value="name">Name</option>
    			<option value="country">Land</option>
    			<option value="zipcode">PLZ</option>
    			<option value="category" selected>Kategorie</option>
    			<option value="rank">Rang</option>
    			<option value="table">Tisch</option>
    ## modified to support workareas as per change request for version 1.2.0
    ## cklein
    ## 2008-02-26
    			<option value="workareaname">Arbeitsbereich</option>
    #else
    			<option value="orderno">Laufende Nummer</option>
    			<option value="name" selected>Name</option>
    			<option value="country">Land</option>
    			<option value="zipcode">PLZ</option>
    			<option value="category">Kategorie</option>
    			<option value="rank">Rang</option>
    			<option value="table">Tisch</option>
    ## modified to support workareas as per change request for version 1.2.0
    ## cklein
    ## 2008-02-26
    			<option value="workareaname">Arbeitsbereich</option>
    #end
    		</select>
    	</td>
    </tr><tr>
    	<td class="label" style="width: 19%;">&nbsp;</td>
    	<td class="value">
    		<select name="sort3" >
    #if($search.listorder == "lastname_a_e1" || $search.listorder == "firstname_a_e1" || $search.listorder == "mail_a_e1")
    			<option value=""></option>
    			<option value="orderno">Laufende Nummer</option>
    			<option value="name">Name</option>
    			<option value="country">Land</option>
    			<option value="zipcode">PLZ</option>
    			<option value="category">Kategorie</option>
    			<option value="rank" selected>Rang</option>
    			<option value="table">Tisch</option>
    ## modified to support workareas as per change request for version 1.2.0
    ## cklein
    ## 2008-02-26
    			<option value="workareaname">Arbeitsbereich</option>
    #else
    			<option value="" selected></option>
    			<option value="orderno">Laufende Nummer</option>
    			<option value="name">Name</option>
    			<option value="country">Land</option>
    			<option value="zipcode">PLZ</option>
    			<option value="category">Kategorie</option>
    			<option value="rank">Rang</option>
    			<option value="table">Tisch</option>
    ## modified to support workareas as per change request for version 1.2.0
    ## cklein
    ## 2008-02-26
    			<option value="workareaname">Arbeitsbereich</option>
    #end
    		</select>
    	</td>
    </tr></table><br>
    
    <div class="hinweis grayBorder"><strong>Hinweis</strong><p>
    			Sollten Sie in der G&auml;steliste eine Filterung getroffen haben, werden nur die
    			ausgew&auml;hlten G&auml;ste exportiert.
    		</p>
    </div>
    
    #if($exportCalc.total > $exportCalc.available)
    <div class="hinweis contentBoxColored grayBorder marginBottom20">
        #if ($diff == 1)
        <strong>Ein Gast</strong> kann <strong>nicht exportiert</strong> werden,
        weil zu dieser Person keine entsprechenden Dokumenttyp
        spezifische Daten gespeichert worden sind.
        #else
        <strong>$!diff G&auml;ste</strong> k&ouml;nnen <strong>nicht exportiert</strong> werden,
        weil nicht zu jeder Person entsprechende Dokumenttyp
        spezifische Daten gespeichert worden sind.
        #end
    </div>
    #end
    
	<div class="textRight marginTop10" id="buttonPanel-bottom">
    
		<input type="button" name="export" value="Exportieren" title="Exportieren" class="mainButton" onclick="document.getElementById('ExportForm').action='ExportGuestDoctype/export.${extension}'; submit();">
		<input type="button" name="cancel" value="Zur&uuml;ck zur Veranstaltung" title="Zur&uuml;ck zur Veranstaltung" class="mainButton" onclick="window.location.href='ShowGuestList';">
    
    </div>
    
    </form>
    
    #else
    
    <div class="hinweis contentBoxColored grayBorder marginBottom20 marginTop20">
		Der Veranstaltung wurden noch keine Dokumenttypen zugeordnet.
    </div>
    
    <div class="textRight marginTop10" id="buttonPanel-bottom">
    
		<input type="button" name="cancel" value="Zur&uuml;ck zur Veranstaltung" title="Zur&uuml;ck zur Veranstaltung" class="mainButton" onclick="window.location.href='ShowGuestList';" class="mainButton" />
    
    </div>
    
    #end
</div>



#parse("inc/footer.vm")