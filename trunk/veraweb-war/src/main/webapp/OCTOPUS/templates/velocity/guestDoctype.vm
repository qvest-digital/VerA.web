#set($activeMenu = "Veranstaltungen")
#set($title = "G&auml;steliste f&uuml;r Veranstaltung: $!message.plain($event.shortname)")
#parse("inc/header.vm")


<div id="content_container">
	<div id="breadcrumb" class="textRight marginBottom10">
    		<strong>Sie sind hier</strong> <span><a href="${paths.staticWeb}do/" title="Zur Startseite">Home</a> > Veranstaltungen > Veranstaltung bearbeiten</span>
    </div>
    <h1>G&auml;steverwaltung der Veranstaltung: $!message.plain($event.shortname)</h1>
	
	#if(!$isNewEvent)
		#set($completeEventHeader = true)
      	#parse("inc/event-header.vm")
    #end
	
	<div class="tabs contentBox grayBorder marginBottom10 marginTop20" id="main_content">
    	<div id="tabsMain">
    		<ul vera-tab-group="" class="gray-gradient"> <!-- Bitte das End-tag der <li>s immer mit in die nächste Zeile nehmen (verhindert Mozilla styling bug) -->
    			<li id="gaesteliste" onclick=""  vera-tab="" class="inactive">G&auml;steliste
    			</li><li id="gastdetails" onclick="" vera-tab="" class="inactive">Gastdetails
    			</li><li id="dokumenttypen" vera-tab-default="" class="active">Dokumenttypen
    			</li>
    		</ul>
    	</div>
		
		<div class="contentBoxColored tabsContent">

            <table class="form"><tr>
            ## Bug 1591 im Kopf nicht die Stammdaten anzeigen
            	#if($showGuestListData)
            		#if ($guestListData.firstname && $guestListData.firstname.length() > 0 && $guestListData.lastname && $guestListData.lastname.length() > 0)
            			#set($name = "$!guestListData.firstname $!guestListData.lastname")
            		#else
            			#set($name = "$!guestListData.firstname$!guestListData.lastname")
            		#end
            		#set($email = "$!guestListData.mail")
            		#if ($guestListData.firstname_p && $guestListData.firstname_p.length() > 0 && $guestListData.lastname_p && $guestListData.lastname_p.length() > 0)
            			#set($name_p = "$!guestListData.firstname_p $!guestListData.lastname_p")
            		#else
            			#set($name_p = "$!guestListData.firstname_p$!guestListData.lastname_p")
            		#end
            		#set($funktion = "$!guestListData.function")
            	#else
            		#set($facade = $main)
            		#if($facade.Firstname && $facade.Firstname.length() > 0 && $facade.Lastname && $facade.Lastname.length() > 0)
            			#set($name = "$!facade.Firstname $!facade.Lastname")
            		#else
            			#set($name = "$!facade.Firstname$!facade.Lastname")
            		#end
            		#set($email = "$!address.EMail")
            		#set($facade = $partner)
            		#if($facade.Firstname && $facade.Firstname.length() > 0 && $facade.Lastname && $facade.Lastname.length() > 0)
            			#set($name_p = "$!facade.Firstname $!facade.Lastname")
            		#else
            			#set($name_p = "$!facade.Firstname$!facade.Lastname")
            		#end
            		#set($funktion = "$!address.Function")
            	#end
            	
            	<td class="label" style="width: 19%;"><strong>Gast</strong></td>
            	<td class="value" style="width: 31%;"><input type="text" id="person-main" name="person-main" value="$!message.text($name)" class="textdisabled" style="width: 90%;" vera-disabled></td>
            ## added mailto: link as per change request for version 1.2.0
            ## cklein 2008-03-03
            	<td class="label"><label style="float:left;" for="person-mail$ext">E-Mail</label>#if($email && $email.length()>0)<a style="float:right;" href="mailto:$!message.text($email)"><img src="${paths.staticWeb}images/email.gif"></a>#end</label></td>
            	<td class="value" style="width: 31%;"><input type="text" id="person-mail" name="person-mail" value="$!message.text($email)" class="textdisabled" style="width: 90%;" vera-disabled></td>
            </tr><tr>
            	
            	<td class="label" style="width: 19%;">Partner:</td>
            	<td class="value" style="width: 31%;"><input type="text" id="person-partner" name="person-partner" value="$!message.text($name_p)" class="textdisabled" style="width: 90%;" vera-disabled></td>
            	<td class="label" style="width: 19%;">Laufende Nummer:</td>
            	<td class="value" style="width: 31%;""><input type="text" id="guest-orderno_a" name="guest-orderno_a" value="#if($guest.orderno_a)$!guest.orderno_a#else$!guest.orderno_b#end" class="intdisabled" vera-disabled></td>
            </tr><tr>
            	<td class="label" style="width: 19%;">Funktion:</td>
            	<td class="value" style="width: 31%;"><input type="text" id="person-function" name="person-function" value="$!message.text($funktion)" class="textdisabled" style="width: 90%;" vera-disabled></td>
            	<td class="label" style="width: 19%;">&nbsp;</td>
            	<td class="value" style="width: 31%;"">&nbsp;</td>
            </tr></table>
            
            <div class="notBold hinweis grayBorder marginBottom10">
				<strong>Hinweis</strong>
				<p>Sie bearbeiten hier ausschließlich Personendaten im Rahmen der aktuellen Veranstaltung, <i>keine</i> grundlegenden Stammdaten.</p>
            </div>
			
			<div id="buttonPanel-bottom" class="textRight marginBottom20">
				<input type="button" onclick="window.location.href='ReloadGuestData?guest-id=$!guest.id&show=doctype';" title="Alle Werte auf Stammdaten zurücksetzen" value="Auf Stammdaten zurücksetzen" name="refresh">
				<input type="button" onclick="window.location.href='ShowPerson?id=$guest.person&action=event';" title="Personenstammdaten bearbeiten" value="Stammdaten bearbeiten" name="persondata">
            </div>
            
            #if (!$allDoctype || $allDoctype.size() != 0)
			<h3 class="marginBottom10">Dokumenttyp wählen</h3>
            <form action="ShowGuestDoctype" method="get" class="marginBottom40">
				
			<div class="inlineLabel">
				<label for="">Dokumenttyp</label>
				<select id="doctype-id" name="doctype-id" onChange="submit();">
            			#foreach($doc in $allDoctype)
            			<option value="$!doc.doctype" #if($doc.doctype == $guestdoctype.doctype) selected#end>$!message.text($doc.name)</option>
            			#end
            	</select>
			</div>	
            </form>
            #end
            
            #if ($guestdoctype && $guestdoctype.id)
            <form id="ReloadGuestDoctypeForm" action="SaveGuestDoctype" method="post">
                <input type="hidden" name="create" value="true">
                <input type="hidden" name="guestdoctype-id" value="$!guestdoctype.id">
                <input type="hidden" name="guestdoctype-guest" value="$!guestdoctype.guest">
                <input type="hidden" name="guestdoctype-doctype" value="$!guestdoctype.doctype">
                <input type="hidden" name="guestdoctype-person" value="$!guestdoctype.person">
                
                <input type="hidden" id="reloadguestdoctype-addresstype" name="guestdoctype-addresstype" value="$!guestdoctype.addresstype">
                <input type="hidden" id="reloadguestdoctype-locale" name="guestdoctype-locale" value="$!guestdoctype.locale">
            </form>
            
            <form id="GuestForm" name="GuestForm" action="SaveGuestDoctype" method="post">
            
                <input type="hidden" name="guestdoctype-id" value="$!guestdoctype.id">
                <input type="hidden" name="guestdoctype-guest" value="$!guestdoctype.guest">
                <input type="hidden" name="guestdoctype-doctype" value="$!guestdoctype.doctype">
                <input type="hidden" name="guestdoctype-person" value="$!guestdoctype.person">
                
                <input type="hidden" name="guestdoctype-addresstype" value="$!guestdoctype.addresstype">
                <input type="hidden" name="guestdoctype-locale" value="$!guestdoctype.locale">
					
				<h3 class="marginBottom10">Adresstyp und Zeichensatz wählen</h3>
				
				<div class="table marginBottom40">
					<div class="tableRow">
						<div class="tableCell">
							<label for="select-addresstype">Adresstyp</label> 
							<select id="select-addresstype" name="select-addresstype">
                    			<option value="1" #if($guestdoctype.addresstype == 1) selected#end>$!config.business</option>
                    			<option value="2" #if($guestdoctype.addresstype == 2) selected#end>$!config.private</option>
                    			<option value="3" #if($guestdoctype.addresstype == 3) selected#end>$!config.other</option>
							</select>
						</div>
						<div class="tableCell">
							<label for="select-locale">Zeichensatz</label>
							<select id="select-locale" name="select-locale">
                    			<option value="1" #if($guestdoctype.locale == 1) selected#end>$!config.latin</option>
                    			<option value="2" #if($guestdoctype.locale == 2) selected#end>$!config.extra1</option>
                    			<option value="3" #if($guestdoctype.locale == 3) selected#end>$!config.extra2</option>
                    		</select>
							
						</div>
						<div class="tableCell" style="vertical-align:bottom;">
							<input type="button" name="create" value="Neu laden" onclick="reloadGuestDoctype();">
						</div>
					</div>
				</div>

				<h3 class="marginBottom10">Daten bearbeiten</h3>
				
				<div class="table width100">
					<div class="tableRow">
						<div class="tableCell width50">
							<label for="guestdoctype-textfield">Freitextfeld</label>
							<textarea id="guestdoctype-textfield" name="guestdoctype-textfield" >$!message.textarea($guestdoctype.textfield)</textarea>
						</div>
						<div class="tableCell width50">
							<label for="guestdoctype-textfield_p">Freitextfeld (Partner)</label>
							<textarea id="guestdoctype-textfield_p" name="guestdoctype-textfield_p" >$!message.textarea($guestdoctype.textfield_p)</textarea>
						</div>
					</div>
					<div class="tableRow">
						<div class="tableCell">
							<label for="guestdoctype-textjoin">Verbinder</label>
							<input type="text" id="guestdoctype-textjoin" name="guestdoctype-textjoin" maxlength="50" value="$!message.text($guestdoctype.textjoin)" >
						</div>
						<div class="tableCell"></div>
					</div>
				</div>
                
				
				<fieldset class="width49 inline">
					<legend>Persönliche Daten (Hauptperson)</legend>
					<div class="table">
						<div class="tableRow">
							<div class="tableCell">
								<label for="guestdoctype-salutation">Anrede</label>
								<input type="text" id="guestdoctype-salutation" maxlength="50" name="guestdoctype-salutation" value="$!message.text($guestdoctype.salutation)" />
							</div>
						</div>
						<div class="tableRow">
							<div class="tableCell">
								<label for="guestdoctype-titel">Akad. Titel</label>
								<input type="text" id="guestdoctype-titel" maxlength="250" name="guestdoctype-titel" value="$!message.text($guestdoctype.titel)" />
							</div>
						</div>
						<div class="tableRow">
							<div class="tableCell">
								<label for="guestdoctype-firstname">Vorname</label>
								<input type="text" id="guestdoctype-firstname" maxlength="100" name="guestdoctype-firstname" value="$!message.text($guestdoctype.firstname)" />
							</div>
						</div>
						<div class="tableRow">
							<div class="tableCell">
								<label for="guestdoctype-lastname">Nachname</label>
								<input type="text" id="guestdoctype-lastname" maxlength="100" name="guestdoctype-lastname" value="$!message.text($guestdoctype.lastname)" />
							</div>
						</div>
						<div class="tableRow">
							<div class="tableCell">
								<label for="">Funktion / Amtsbez.</label>
								<input type="text" id="guestdoctype-function" maxlength="250" name="guestdoctype-function" value="$!message.text($guestdoctype.function)" />
							</div>
						</div>
						<div class="tableRow">
							<div class="tableCell">
								<label for="guestdoctype-company">Firma / Institution</label>
								<input type="text" id="guestdoctype-company" maxlength="250" name="guestdoctype-company" value="$!message.text($guestdoctype.company)" >
							</div>
						</div>
					</div>
				</fieldset>
				
                <fieldset class="width49 inline">
					<legend>Persönliche Daten (Partner)</legend>
					<div class="table width100">
						<div class="tableRow">
							<div class="tableCell">
								<label for="guestdoctype-salutation_p">Anrede (Partner)</label>
								<input type="text" id="guestdoctype-salutation_p" maxlength="50" name="guestdoctype-salutation_p" value="$!message.text($guestdoctype.salutation_p)" />
							</div>
						</div>
						<div class="tableRow">
							<div class="tableCell">
								<label for="guestdoctype-titel_p">Akad. Titel (Partner)</label>
								<input type="text" id="guestdoctype-titel_p" maxlength="250" name="guestdoctype-titel_p" value="$!message.text($guestdoctype.titel_p)" />
							</div>
						</div>
						<div class="tableRow">
							<div class="tableCell">
								<label for="guestdoctype-firstname_p">Vorname (Partner)</label>
								<input type="text" id="guestdoctype-firstname_p"maxlength="100" name="guestdoctype-firstname_p" value="$!message.text($guestdoctype.firstname_p)" />
							</div>
						</div>
						<div class="tableRow">
							<div class="tableCell">
								<label for="guestdoctype-lastname_p">Nachname (Partner)</label>
								<input type="text" id="guestdoctype-lastname_p" maxlength="100" name="guestdoctype-lastname_p" value="$!message.text($guestdoctype.lastname_p)" />
							</div>
						</div>
					</div>
                </fieldset>
                
                <table class="form"><tr>
                	<td class="label" style="width: 19%;">Stra&szlig;e:</td>
                	<td class="value"><input type="text" maxlength="100" id="guestdoctype-street" name="guestdoctype-street" value="$!message.text($guestdoctype.street)" ></td>
                </tr><tr>
                	<td class="label"><label for="guestdoctype-zipcode">PLZ</label> / <label for="guestdoctype-city">Ort</label></td>
                	<td class="value">
                		<table class="form" border="0" cellpadding="0" cellspacing="0"><tr>
                			<td class="value" style="width: 60px;"><input type="text" id="guestdoctype-zipcode" maxlength="50" name="guestdoctype-zipcode" value="$!message.text($guestdoctype.zipcode)" ></td>
                			<td class="value" style="width: 10px;">&nbsp;</td>
                			<td class="value"><input type="text" id="guestdoctype-city" name="guestdoctype-city" maxlength="100" value="$!message.text($guestdoctype.city)" ></td>
                		</tr></table>
                	</td>
                </tr><tr>
                	<td class="label"><label for="guestdoctype-poboxzipcode">Postfach PLZ</label> / <label for="guestdoctype-pobox">Nummer</label></td>
                	<td class="value">
                		<table class="form" border="0" cellpadding="0" cellspacing="0"><tr>
                			<td class="value" style="width: 60px;"><input type="text" id="guestdoctype-poboxzipcode" maxlength="50" name="guestdoctype-poboxzipcode" value="$!message.text($guestdoctype.poboxzipcode)" ></td>
                			<td class="value" style="width: 10px;">&nbsp;</td>
                			<td class="value"><input type="text" id="guestdoctype-pobox" name="guestdoctype-pobox" maxlength="50" value="$!message.text($guestdoctype.pobox)" ></td>
                		</tr></table>
                	</td>
                </tr><tr>
                	<td class="label">$!config.suffix1:</td>
                	<td class="value"><input type="text" id="guestdoctype-suffix1" maxlength="100" name="guestdoctype-suffix1" value="$!message.text($guestdoctype.suffix1)" ></td>
                </tr><tr>
                	<td class="label">$!config.suffix2:</td>
                	<td class="value"><input type="text" id="guestdoctype-suffix2" maxlength="100" name="guestdoctype-suffix2" value="$!message.text($guestdoctype.suffix2)" ></td>
                </tr><tr>
                	<td class="label">Land:</td>
                	<td class="value"><input type="text" id="guestdoctype-country" maxlength="100" name="guestdoctype-country" value="$!message.text($guestdoctype.country)" ></td>
                </tr></table>
                
                <hr class="contentsection" />
                
                <table class="form"><tr>
                	<td class="label" style="width: 19%;">Telefon:</td>
                	<td class="value"><input type="text" id="guestdoctype-fon" maxlength="100" name="guestdoctype-fon" value="$!message.text($guestdoctype.fon)" ></td>
                </tr><tr>
                	<td class="label">Fax:</td>
                	<td class="value"><input type="text" id="guestdoctype-fax" maxlength="100" name="guestdoctype-fax" value="$!message.text($guestdoctype.fax)" ></td>
                </tr><tr>
                ## added mailto: link as per change request for version 1.2.0
                ## cklein 2008-02-21
                	<td class="label"><label style="float:left;" for="person-mail$ext">E-Mail</label>#if($email && $email.length()>0)<a style="float:right;" href="mailto:$!message.text($email)"><img src="${paths.staticWeb}images/email.gif"></a>#end</label></td>
                	<td class="value"><input type="text" maxlength="250" id="guestdoctype-mail" name="guestdoctype-mail" value="$!message.text($guestdoctype.mail)" ></td>
                </tr><tr>
                	<td class="label">www:</td>
                	<td class="value"><input type="text" maxlength="250" id="guestdoctype-www" name="guestdoctype-www" value="$!message.text($guestdoctype.www)" ></td>
                </tr><tr>
                	<td class="label">Mobil:</td>
                	<td class="value"><input type="text" maxlength="100" id="guestdoctype-mobil" name="guestdoctype-mobil" value="$!message.text($guestdoctype.mobil)" ></td>
                </tr></table>
                
                #else
                
                <div style="margin: 10px 0px 10px 0px; padding: 10px 10px 10px 10px; background-color: #ffffff; border: 2px solid #ff0000;">
                	Bitte &uuml;berpr&uuml;fen Sie ob dieser Veranstaltung
                	bereits Dokumenttypen zugeordnet sind. Sollte dies der
                	Fall sein m&uuml;ssen Sie die Dokumenttypen f&uuml;r diesen
                	Gast neu erzeugen, klicken Sie hierzu auf &quot;Neu Laden&quot;.
                </div>
                
                #end
                
                <div>
                
                #parse("inc/guest-doctype-navi.vm")
                
                
                    <input type="submit" name="save" value="Speichern" #if($grants.mayWrite()) class="button" #else class="buttondisabled" vera-disabled #end> &nbsp;
                    <input type="button" name="cancel" value="Zur&uuml;ck" title="Zur&uuml;ck zu den Veranstaltungdetails" class="reset" onclick="window.location.href='ShowGuestList';"> &nbsp;
                
                </div>
            
            </form><!-- End id="GuestForm" -->
		</div>

<script type="text/javascript">
	function reloadGuestDoctype() {
		var sa = document.getElementById('select-addresstype');
		var sl = document.getElementById('select-locale');
		var ra = document.getElementById('reloadguestdoctype-addresstype');
		var rl = document.getElementById('reloadguestdoctype-locale');
		
		ra.value = sa[sa.selectedIndex].value;
		rl.value = sl[sl.selectedIndex].value;
		document.getElementById('ReloadGuestDoctypeForm').submit();
	}

    #if(!$grants.mayWrite())
    	disableForm(document.getElementById('GuestForm'));
    #end

	$(function () {
        $('li#gaesteliste').click(function () {
            window.location.href = '${paths.staticWeb}do/ShowGuestList';
        });
		
        $('li#gastdetails').click(function () {
            window.location.href = '${paths.staticWeb}do/ShowGuestDetail';
        });
    });
</script>
</div>
</div>

#parse("inc/footer.vm")