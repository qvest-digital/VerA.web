#set($activeMenu = "Veranstaltungen")
#set($title = "G&auml;steliste f&uuml;r Veranstaltung: $!message.plain($event.shortname)")
#parse("inc/header.vm")

<div id="content_container">
	<div id="breadcrumb" class="textRight marginBottom10">
    	<strong>Sie sind hier</strong> <span><a href="${paths.staticWeb}do/" title="Zur Startseite">Home</a> > Veranstaltungen > Veranstaltung bearbeiten</span>
    </div>
    <h1>G&auml;steverwaltung der Veranstaltung: $!message.plain($event.shortname)</h1>
	
	#if(!$isNewEvent)
		#set($completeEventHeader = true)
      	#parse("inc/event-header.vm")
	#end
	
    #set($isUser = false)
    #set($isAdmin = false)
    #foreach($group in $octopusConfig.personalConfig.UserGroups)
    	#if($group == "Writer")
    		#set($isUser = true)
    	#elseif($group == "PartialAdmin")
    		#set($isAdmin = true)
    	#elseif($group == "Administrator")
    		#set($isAdmin = true)
    	#end
    #end

    #if($invited)
    	<div style="margin: 10px 0px 0px 0px; padding: 2px 3px 2px 3px; background-color: #ffc080; border: 1px solid #ff8000;">
    		#if($invited == 0)
    			Die G&auml;steliste wurde nicht ver&auml;ndert.
    		#elseif($invited == 1)
    			Die G&auml;steliste wurde um einen Gast erweitert.
    		#else
    			Die G&auml;steliste wurde um $invited G&auml;ste erweitert.
    		#end
    	</div>
    #end
    #if($mailinglistParams && $mailinglistParams.count)
    	<div style="margin: 10px 0px 0px 0px; padding: 2px 3px 2px 3px; background-color: #ffc080; border: 1px solid #ff8000;">
    		#if($mailinglistParams.count == 0)
    			Verteiler &quot;$!message.plain($mailinglist.name)&quot; wurde ohne Person angelegt.
    		#elseif($mailinglistParams.count == 1)
    			Verteiler &quot;$!message.plain($mailinglist.name)&quot; wurde mit einer Person angelegt.
    		#else
    			Verteiler &quot;$!message.plain($mailinglist.name)&quot; wurde mit $!mailinglistParams.count Personen angelegt.
    		#end
    	</div>
	#end
	
    #if($octopusRequest.task == "CalcSerialNumber" && (!$listquestions || $listquestions.size() == 0))
		<div style="margin: 10px 0px 0px 0px; padding: 2px 3px 2px 3px; background-color: #ffc080; border: 1px solid #ff8000;">
    		Die &quot;Laufende Nummer&quot; wurde f&uuml;r alle G&auml;ste neu berechnet und gespeichert.
    	</div>
    #end
    <div class="tabs contentBox grayBorder marginBottom10 marginTop20" id="main_content">

		<div id="tabsMain">
			<ul vera-tab-group="" class="gray-gradient"> <!-- Bitte das End-tag der <li>s immer mit in die nächste Zeile nehmen (verhindert Mozilla styling bug) -->
    			<li id="gaesteliste" vera-tab class="active posRel" style="z-index:2">G&auml;steliste
				</li><li id="gastdetails" class="inactive">Gastdetails
				</li><li id="dokumenttypen" class="inactive">Dokumenttypen
				</li>
			</ul>
		</div>
		
		<div class="contentBoxColored tabsContent notBold posRel" vera-content="">
			
			<div id="guestSummary" class="table posAb hinweis grayBorder" style="padding-bottom: 5px;">
				<div class="tableRow">
					<div class="tableCell"><strong>Offen:</strong> $!guestlist-sums.offen</div>
					<div class="tableCell"><strong>Zusagen:</strong> $!guestlist-sums.zusagen</div>
					<div class="tableCell"><strong>Absagen:</strong> $!guestlist-sums.absagen</div>
					<div class="tableCell"><strong>Teilnahmen:</strong> $!guestlist-sums.teilnahmen</div>
					<div class="tableCell"><strong>Auf&nbsp;Platz:</strong> $!guestlist-sums.platz</div>
					<div class="tableCell"><strong>Auf&nbsp;Reserve:</strong> $!guestlist-sums.reserve</div>
				</div>
			</div>
            
            <form id="guestListFilter" name="guestListFilter" action="ShowGuestList" method="POST" class="marginTop25">
                <input type="hidden" name="start" value="0">
				<input type="hidden" name="limit" value="" />
                <input type="hidden" name="selectAll" value="false">
                <input type="hidden" name="selectNone" value="true">
                <input type="hidden" name="search-event" value="$search.event">
                <input type="hidden" id="search-listorder" name="search-listorder" value="$!search.listorder">
        			
                <h3 class="marginBottom0">Filter</h3>
        		
        		<div class="table width50">
        			<div class="tableRow">
        				<div class="tableCell width50">
        					<label for="search-reserve">Platzwahl</label>
                    		<select name="search-reserve" id="search-reserve" onchange="submit();">
                            			<option value="">Alle G&auml;ste</option>
                            			<option #if($search.reserve && $search.reserve == 1) selected#end value="1">Alle G&auml;ste auf Platz</option>
                            			<option #if($search.reserve && $search.reserve == 2) selected#end value="2">Alle G&auml;ste auf Reserve</option>
                            </select>
        				</div>
        				<div class="tableCell width50">
                    		<label for="search-invitationstatus">Status</label>
                    		<select name="search-invitationstatus" id="search-invitationstatus" onchange="submit();">
                            			<option value="">Alle</option>
                            			<option #if($search.invitationstatus && $search.invitationstatus == 1) selected#end value="1">nur Offene</option>
                            			<option #if($search.invitationstatus && $search.invitationstatus == 2) selected#end value="2">nur Zusagen</option>
                            			<option #if($search.invitationstatus && $search.invitationstatus == 3) selected#end value="3">nur Absagen</option>
                            			<option #if($search.invitationstatus && $search.invitationstatus == 4) selected#end value="4">nur Teilnahmen</option>
                            </select>				
        				</div>
        			</div>
        		</div>
        
            </form>
            
            #if($listerrors.size() > 0)
                <div style="margin: 10px 0px 10px 0px; padding: 10px 10px 10px 10px; background-color: #ffffff; border: 2px solid #ff0000;">
                	#foreach($error in $listerrors)
                		$error<br>
                	#end
                </div>
            #elseif($listquestions && $listquestions.size() > 0)
                <form action="" method="POST">
                <div style="margin: 10px 0px 10px 0px; padding: 10px 10px 10px 10px; background-color: #ffffff; border: 2px solid #00ff00;">
                	<strong>Bitte best&auml;tigen Sie die folgende Aktion</strong><br>
                	<table class="form" style="margin: 5px 0px 0px 0px;">
                	#foreach($quest in $listquestions.entrySet())
                		<tr>
                			<td class="value"><input type="hidden" name="$quest.key" value="true">$quest.value</td>
                		</tr>
                		#set($save = true)
                	#end
                	</table><br>
                
                	#if($save)
						<input type="submit" class="button" name="remove" value="Ja"> &nbsp;
					#end
					
                	<input type="button" class="cancel" name="cancel" value="Nein" onclick="window.location.href='ShowGuestList';"> &nbsp;
                </div>
                </form>
            #end
            
            <form id="formlist" name="formlist" action="ShowGuestList" method="POST">
            <input type="hidden" name="start" value="">
			<input type="hidden" name="limit" value="" />
            <input type="hidden" name="selectAll" value="false">
            <input type="hidden" name="selectNone" value="false">
            <input type="hidden" name="doInsert" value="false">
            <input type="hidden" name="doUpdate" value="true">
            <input type="hidden" name="doRemove" value="true">
            <input type="hidden" name="categoryAssignmentAction" value="">
            <input type="hidden" name="categoryAssignmentId" value="">
            <input type="hidden" name="workareaAssignmentAction" value="">
            <input type="hidden" name="workareaAssignmentId" value="">
            
            #foreach($bean in $list)
				<input type="hidden" name="list" value="$bean.id">
        	#end

			<!-- neu -->
			<div class="table width100">
                <div class="tableRow">
                        <div class="tableCell width35 inlineInput" style="padding-bottom:0"><label for="actionSelection">Markierte Person(en)</label>
                    			<select id="actionSelection" class="autoWidth">
                    				<option>Löschen</option>
                    				<option>Kategorien zuordnen</option>
                            		<option>Kategorien entfernen</option>
                            		<option>Verteiler erstellen</option>
                            		<option>Steuerdatei exportieren</option>
                                </select>
                            	<input type="button" name="button.execute" id="button.execute" value="Durchführen" class="autoWidth">
            			</div>
            			<div class="tableCell textRight" style="vertical-align:bottom; padding-bottom:0">
            				#if($grants.mayWrite()) 
								<input type="button" class="mainButton inlineInput autoWidth" name="createGuestList" value="G&auml;steliste erstellen" title="G&auml;steliste erstellen" onclick="submitFormWithGivenAction('ShowReportGuestList', $grants.mayWrite());" />
								<input type="button" class="mainButton inlineInput autoWidth" name="addGuestsFromEvent" value="G&auml;ste aus Veranstaltung &uuml;bernehmen" title="G&auml;ste aus Veranstaltung &uuml;bernehmen" onclick="window.location.href='AddEventToEventSearch?action=guest';" />
								<input type="button" class="mainButton inlineInput autoWidth" name="add" value="Gast hinzuf&uuml;gen" title="Personen suchen und zu der G&auml;steliste hinzuf&uuml;gen" onclick="window.location.href='AddPersonToEventSearch?action=guest&search=clear';" />
							#end
						</div>
               	</div>
            </div><!--neu -->
			
			## Handler für selektierte Aktion 
    		<script>
    			$(function () {
				
    				$('#button\\.execute').click(function (e) {					
    					var selectText = $('#actionSelection option:selected').text();
    					
						if(hasSelection()){
        					if (selectText == "Löschen") {
    							selectedActionRemoveGuest();
        					} else if (selectText == "Kategorien zuordnen") {
        						assignCategories();
        					} else if (selectText == "Kategorien entfernen") {
        						unassignCategories();
        					} else if (selectText == "Verteiler erstellen") {
        						submitFormWithGivenAction('CreateMailinglist', $grants.mayWrite());
        					} else if (selectText == "Steuerdatei exportieren") {
        						submitFormWithGivenAction('ShowExportGuestDoctype', $grants.mayExport()); 
        					}
						} else {
            				alert( "Wählen Sie bitte zunächst eine oder mehrere Personen aus." );
            			}
    				});
     			});	
				
				var selectedCount = ${listselection.size()};
        	
            	function hasSelection() {
            		return ( selectedCount > 0 );
            	}
            
            	function selectionChange( elt ) {
            		selectedCount += ( elt.checked ? 1 : -1 );
            	}
				
				function selectedActionRemoveGuest() {
					var confirmResult = false;
                    #if($isUser)
                		confirmResult = confirm('Markierten Gast wirklich entfernen?');
                    #elseif($isAdmin)
                		confirmResult = confirm('Sollen alle markierten Gäst entfernt werden?');
                    #else
                		alert('Sie haben keine ausreichende Berechtigung um Gäste zu entfernen.');
                    #end
					if (confirmResult) {
						$('<input>').attr({ type: 'hidden', id: 'remove', name: 'remove' }).appendTo($('#formlist'));
					}
					document.formlist.submit();
				}
				
            	function unassignCategories() {
            		selectPersonCategory( "${paths.staticWeb}do/popupUnassignGuestCategory?count=" + selectedCount + "&eventId=" + ${event.id} );
            	}
            	
            	function assignCategories() {
            		selectPersonCategory( "${paths.staticWeb}do/popupAssignGuestCategory?count=" + selectedCount + "&eventId=" + ${event.id} );
            	}  
				
				function submitFormWithGivenAction(action, permission) {
					if(permission){
    					htmlWait();
    					document.getElementById('formlist').action = action;
        				document.formlist.submit();
					} else {
						alert('Sie haben keine ausreichende Berechtigung um diese Aktion auszuführen.');
					}
				}
    		</script>
        	
            <table>
            	<tr>
					<th class="textCenter smallCell"><input type="checkbox" name="toggleAllSelect" id="toggleAllSelect" #if($listselection.size() == $listparam.count) checked#end title="Alle (de)markieren"/></th>
            #if($search.listorder == "lastname_a_e1")
            		<th class="textCenter smallCell"><a href="javascript:orderGuestList('orderno');"><nobr>Lfd.-Nr.</nobr></a></th>
            		<th style="width: 25px; text-align: center;" title="Auf Reserve / Platz">R</th>
            		<th><a href="javascript:orderGuestList('lastname_a_e1');" style="color: #000000;">Name</a></th>
            		<th><a href="javascript:orderGuestList('firstname_a_e1');">Vorname</a></th>
            		<th style="width: 20px;"><a href="javascript:orderGuestList('mail_a_e1');">E-Mail</a></th>
            #elseif($search.listorder == "firstname_a_e1")
            		<th style="width: 50px;"><a href="javascript:orderGuestList('orderno');"><nobr>Lfd.-Nr.</nobr></a></th>
            		<th style="width: 25px; text-align: center;" title="Auf Reserve / Platz">R</th>
            		<th><a href="javascript:orderGuestList('lastname_a_e1');">Name</a></th>
            		<th><a href="javascript:orderGuestList('firstname_a_e1');" style="color: #000000;">Vorname</a></th>
            		<th style="width: 20px;"><a href="javascript:orderGuestList('mail_a_e1');">E-Mail</a></th>
            #elseif($search.listorder == "mail_a_e1")
            		<th style="width: 50px;"><a href="javascript:orderGuestList('orderno');"><nobr>Lfd.-Nr.</nobr></a></th>
            		<th style="width: 25px; text-align: center;" title="Auf Reserve / Platz">R</th>
            		<th><a href="javascript:orderGuestList('lastname_a_e1');">Name</a></th>
            		<th><a href="javascript:orderGuestList('firstname_a_e1');">Vorname</a></th>
            		<th style="width: 20px;"><a href="javascript:orderGuestList('mail_a_e1');" style="color: #000000;">E-Mail</a></th>
            #else
            		<th style="width: 50px;"><a href="javascript:orderGuestList('orderno');" style="color: #000000;"><nobr>Lfd.-Nr.</nobr></a></th>
            		<th style="width: 25px; text-align: center;" title="Auf Reserve / Platz">R</th>
            		<th><a href="javascript:orderGuestList('lastname_a_e1');">Name</a></th>
            		<th><a href="javascript:orderGuestList('firstname_a_e1');">Vorname</a></th>
            		<th style="width: 20px;"><a href="javascript:orderGuestList('mail_a_e1');">E-Mail</a></th>
			#end
			
            #if($userConfig.guestListFunction)
            		<th>Funktion</th>
			#end
			
            #if($userConfig.guestListCity)
            		<th>PLZ / Ort</th>
			#end
			
            #if($userConfig.guestListPhone)
            		<th>Telefon</th>
            #end
            		<th style="width: 100px; text-align: center;">$!config.main</th>
            		<th style="width: 100px; text-align: center;">$!config.partner</th>
            	</tr>
				
            	#set($deletedperson = false)
            	
				#foreach($bean in $list)
                	#if ($bean.deleted == "t")
                    	#set($deletedperson = true)
						
                    	#if ($velocityCount % 2 == 0)
                    		#set($class = "list1error")
                    	#else
                    		#set($class = "list2error")
						#end
						
                    #else
                    	#if ($velocityCount % 2 == 0)
                    		#set($class = "list1")
                    	#else
                    		#set($class = "list2")
                	#end
            	#end
            	
				#set($offset = $listparam.start + $velocityCount)
            	
            	<tr class="$class" onmouseover="onMouseOverList(this);" onmouseout="onMouseOutList(this);">
            		<td><input type="hidden" id="${bean.id}-modified" name="${bean.id}-modified" value="false"><input type="hidden" id="${bean.id}-invitationtype" name="${bean.id}-invitationtype" value="${bean.invitationtype}"><input type="checkbox" name="${bean.id}-select" onChange="selectionChange( this );" value="true"  #if($listselection.indexOf($bean.id) != -1) checked#end></td>
            		<td style="cursor: pointer;" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&offset=$offset';"><input type="hidden" name="${bean.id}-id" value="$bean.id">
            			#if($bean.ishost && $bean.ishost == 1)
            				<em>Gastgeber</em>
            			#elseif($bean.someorderno)
            				$bean.someorderno
            			#else
            				<em>keine</em>
            			#end
            		</td>
					
            		#if($bean.reserve == 1)
						<td style="cursor: pointer; text-align: center;" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&offset=$offset';" title="Auf Reserve"><strong>R</strong></td>
            		#else
						<td style="cursor: pointer; text-align: center;" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&offset=$offset';" title="Auf Platz">&nbsp;</td>
					#end
					
            		<td style="cursor: pointer;" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&offset=$offset';">
                		#if($bean.invitationtype != 3)
            				#if($bean.showdoctype)
								$!message.plain($bean.lastname_a_gd)
							#else
								$!message.plain($bean.lastname_a_e1)
							#end
            			#else
            				#if($bean.showdoctype)
								$!message.plain($bean.lastname_b_gd)
							#else
								$!message.plain($bean.lastname_b_e1)
							#end
            			#end
            		</td>
            		<td style="cursor: pointer;" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&offset=$offset';">
            			#if($bean.invitationtype != 3)
            				#if($bean.showdoctype)$!message.plain($bean.firstname_a_gd)#else$!message.plain($bean.firstname_a_e1)#end
            			#else
            				#if($bean.showdoctype)$!message.plain($bean.firstname_b_gd)#else$!message.plain($bean.firstname_b_e1)#end
            			#end
            		</td>
            		<td>
            			#if($bean.showdoctype)
            				#if($bean.mail_a_gd.length() > 0)
            					<a href="mailto:$!message.plain($bean.mail_a_gd)" title="$!message.plain($bean.mail_a_gd)"><img src="${paths.staticWeb}images/email.gif" alt="eMail"></a>
            				#else
            					&nbsp;
            				#end
            			#else
            				#if($bean.mail_a_e1.length() > 0)
            					<a href="mailto:$!message.plain($bean.mail_a_e1)" title="$!message.plain($bean.mail_a_e1)"><img src="${paths.staticWeb}images/email.gif" alt="eMail"></a>
            				#else
            					&nbsp;
            				#end
            			#end
            		</td>
            #if($userConfig.guestListFunction)
            		<td style="cursor: pointer;" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&offset=$offset';">#if($bean.showdoctype)$!message.plain($bean.function_a_gd)#else$!message.plain($bean.function_a_e1)#end</td>
            #end
            #if($userConfig.guestListCity)
            		<td style="cursor: pointer;" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&offset=$offset';">#if($bean.showdoctype)$!message.plain($bean.zipcode_a_gd) $!message.plain($bean.city_a_gd)#else$!message.plain($bean.zipcode_a_e1) $!message.plain($bean.city_a_e1)#end</td>
            #end
            #if($userConfig.guestListPhone)
            		<td style="cursor: pointer;" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&offset=$offset';">#if($bean.showdoctype)$!message.plain($bean.fon_a_gd)#else$!message.plain($bean.fon_a_e1)#end</td>
            #end
            		<td style="text-align: center;">
            		#if($bean.invitationtype != 3)
            			#if($grants.mayWrite())
            			<select name="${bean.id}-invitationstatus_a"  onchange="setModified('${bean.id}')">
            				<option #if($bean.invitationstatus_a && $bean.invitationstatus_a == 0) selected#end value="0">Offen</option>
            				<option #if($bean.invitationstatus_a && $bean.invitationstatus_a == 1) selected#end value="1">Zusage</option>
            				<option #if($bean.invitationstatus_a && $bean.invitationstatus_a == 2) selected#end value="2">Absage</option>
            				<option #if($bean.invitationstatus_a && $bean.invitationstatus_a == 3) selected#end value="3">Teilgenommen</option>
            			</select>
            			#else
                			#if($bean.invitationstatus_a && $bean.invitationstatus_a == 0)
								Offen
                			#elseif($bean.invitationstatus_a && $bean.invitationstatus_a == 1)
								Zusage
                			#elseif($bean.invitationstatus_a && $bean.invitationstatus_a == 2)
								Absage
                			#elseif($bean.invitationstatus_a && $bean.invitationstatus_a == 3)
								Teilgenommen
                			#end
            			#end
            		#else
            			<input type="hidden" name="${bean.id}-invitationstatus_a" value="$!bean.invitationstatus_a">nicht eingeladen
            		#end
            		</td>
            		<td style="text-align: center;">
            		#if($bean.invitationtype != 2)
            			#if($grants.mayWrite())
                			<select name="${bean.id}-invitationstatus_b"  onchange="setModified('${bean.id}')">
                				<option #if($bean.invitationstatus_b && $bean.invitationstatus_b == 0) selected#end value="0">Offen</option>
                				<option #if($bean.invitationstatus_b && $bean.invitationstatus_b == 1) selected#end value="1">Zusage</option>
                				<option #if($bean.invitationstatus_b && $bean.invitationstatus_b == 2) selected#end value="2">Absage</option>
                				<option #if($bean.invitationstatus_a && $bean.invitationstatus_b == 3) selected#end value="3">Teilgenommen</option>
                			</select>
            			#else
                			#if($bean.invitationstatus_b && $bean.invitationstatus_b == 0)
								Offen
                			#elseif($bean.invitationstatus_b && $bean.invitationstatus_b == 1)
								Zusage
                			#elseif($bean.invitationstatus_b && $bean.invitationstatus_b == 2)
								Absage
                			#elseif($bean.invitationstatus_b && $bean.invitationstatus_b == 3)
								Teilgenommen
                			#end
            			#end
            		#else
            			<input type="hidden" name="${bean.id}-invitationstatus_b" value="$!bean.invitationstatus_b">nicht eingeladen
            		#end
            		</td>
            	</tr>
				#end
				
				#set($itemName = "Gästen")
            	#parse("inc/list-navi-new.vm")
				
            	#if($search.listorder)
					#parse("inc/list-direct-new.vm")
            	#else
					<tr class="colspan">
						<td colspan="99" class="textCenter">
							<strong>Hinweis:</strong> Direkteinsprung: Ist nur bei einer Sortierung nach Name, Vorname oder E-Mail m&ouml;glich.
						</td>
					</tr>
            	#end
				
            </table>
        	
        	<div class="textRight marginBottom20" id="buttonPanel-bottom">
				<input type="button" name="calcSerialNumber" value="Laufende Nummer berechnen" title="Laufende Nummer berechnen" onclick="htmlWait(); window.location.href='CalcSerialNumber';" #if(!$grants.mayWrite()) class="buttondisabled" vera-disabled #end>
				<input type="button" name="reloadAllGuestData" value="Alle Stammdaten neu laden" title="Alle Stammdaten neu laden" onclick="submitFormWithGivenAction('ReloadAllGuestData', $grants.mayWrite());" #if(!$grants.mayWrite()) class="buttondisabled" vera-disabled #end>
        	</div>
            
            #if ($listparam.count == 0)
            	<br>Keine Daten gefunden.<br>
            #end
            
            #if($deletedperson)
                <br><table>
                	<tr style="height: 20px;">
                		<td class="list2error" style="width: 20px;">&nbsp;</td>
                		<td class="list1error">
                			Rot hinterlegte Personen wurden bereits als &quot;zu l&ouml;schen&quot; markiert.
                		</td>
                	</tr>
                </table>
                <br>
            #end
            
			<div class="hinweis contentBoxColored grayBorder marginBottom10">
				<strong>Hinweis</strong>
				<p>Beim Erstellen von Steuerdateien oder G&auml;stelisten wird Ihr oben ausgew&auml;hlter Filter ber&uuml;cksichtigt.<br>
				Wenn Sie einzelne G&auml;ste markieren, werden nur diese exportiert, ansonsten die vollst&auml;ndige Liste.</p>
			</div>
				
            
            <div>
        
				
            
            #set($isUser = false)
            #set($isAdmin = false)
            
			#foreach($group in $octopusConfig.personalConfig.UserGroups)
            	#if($group == "Writer")
            		#set($isUser = true)
            	#elseif($group == "PartialAdmin")
            		#set($isAdmin = true)
            	#elseif($group == "Administrator")
            		#set($isAdmin = true)
            	#end
            #end
            			
            </div>
			
        	<div class="textRight" id="buttonPanel-bottom">
				#if($grants.mayWrite())
					<input type="submit" name="save" value="Speichern" title="Speichern" class="mainButton" />
				#end
                <input type="button" name="cancel" value="Zur&uuml;ck zu den Veranstaltungdetails" title="Zur&uuml;ck zu den Veranstaltungdetails" class="mainButton" onclick="window.location.href='ShowEvent?id=$!event.id&action=event';" />
        	</div>			
            
            </form>
		</div>
	</div>

</div>


<script type="text/javascript">
	function orderGuestList(column) {
		document.getElementById('search-listorder').value = column;
		document.getElementById('guestListFilter').submit();
	}
	
    #if($invited && $invited == 0 && $notInvited && $notInvited == 0 && ! $doNotAlert)
    	alert('Sie haben keine Person ausgewählt.');
    #elseif($notInvited)
        #if($notInvited == 1)
        	alert('Ein Gast stand bereits auf der Gästeliste.');
        #elseif($notInvited > 1)
        	alert('$!notInvited Gäste standen bereits auf der Gästeliste.');
        #end
    #end

    $(function () {
        $('li#gastdetails').click(function () {
            window.location.href = '${paths.staticWeb}do/ShowGuestDetail';
        });
        $('li#dokumenttypen').click(function () {
            window.location.href = '${paths.staticWeb}do/ShowGuestDoctype';
        });
    });

</script>

#parse("inc/footer.vm")