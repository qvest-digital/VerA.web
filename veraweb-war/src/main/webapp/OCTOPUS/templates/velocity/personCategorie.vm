#set($activeMenu = "Personen")
#if($person)
    #set($title = "Person bearbeiten: $!message.plain($person.MainLatin.SaveAs)")
    #parse("inc/header.vm")
#else
    #set($title = "Neue Person anlegen")
    #parse("inc/header.vm")
#end

<div id="content_container"> 

	#if (!$status || ($status && $status.code && $status.code != "saveperson"))
        #if($countInsert && $countInsert > 0)
        	<div style="margin: 10px 0px 0px 0px; padding: 2px 3px 2px 3px; background-color: #ffc080; border: 1px solid #ff8000;">
        		#if($countInsert == 0)
        			Es wurde keine Kategorie hinzugef&uuml;gt.
        		#elseif($countInsert == 1)
        			Es wurde eine Kategorie hinzugef&uuml;gt.
        		#else
        			Es wurden $countInsert Kategorien hinzugef&uuml;gt.
        		#end
        	</div>
        #end
        #if($countUpdate && $countUpdate > 0)
        	<div style="margin: 10px 0px 0px 0px; padding: 2px 3px 2px 3px; background-color: #ffc080; border: 1px solid #ff8000;">
        		#if($countUpdate == 0)
        			Es wurde keine Kategorie ge&auml;ndert.
        		#elseif($countUpdate == 1)
        			Es wurde eine Kategorie ge&auml;ndert.
        		#else
        			Es wurden $countUpdate Kategorien ge&auml;ndert.
        		#end
        	</div>
        #end
        #if($countRemove)
        	<div style="margin: 10px 0px 0px 0px; padding: 2px 3px 2px 3px; background-color: #ffc080; border: 1px solid #ff8000;">
        		#if($countRemove == 0)
        			Es wurde keine Kategorie gel&ouml;scht.
        		#elseif($countRemove == 1)
        			Es wurde eine Kategorie gel&ouml;scht.
        		#else
        			Es wurden $countRemove Kategorien gel&ouml;scht.
        		#end
        	</div>
    	#end
	#end
    
    <div id="breadcrumb" class="textRight marginBottom10">
    	<strong>Sie sind hier</strong> <span><a href="${paths.staticWeb}do/" title="Zur Startseite">Home</a> > Personen > Person bearbeiten</span>
    </div>
    
    <h1>$title</h1>
    
    #parse("inc/person-header.vm")
    
    <div id="main_content" class="tabs contentBox grayBorder marginBottom10">
        <div id="tabsMain">
        	<ul class="gray-gradient" vera-tab-group> <!-- Bitte das End-tag der <li>s immer mit in die nÃ¤chste Zeile nehmen (verhindert Mozilla styling bug) -->
        		<li class="inactive" id="personendaten" onclick="window.location.href='${paths.staticWeb}do/ShowPerson?id=$!person.id&personTab=1&offset=${navigation.current.offset}';">Persondendaten
        		</li><li class="inactive" id="anschriften" onclick="window.location.href='ShowPerson?id=$!person.id&personTab=2&offset=${navigation.current.offset}';">Anschriften
        		</li><li class="inactive" id="dokumenttypen" onclick="window.location.href='ShowPersonDoctypeList?id=$!person.id&offset=${navigation.current.offset}';">Dokumenttypen
        		</li><li class="active" id="kategorien" onclick="window.location.href='ShowPersonCategorieList?id=$!person.id&offset=${navigation.current.offset}';">Kategorien</li>
        	</ul>
        </div>
    	
    	<div class="contentBoxColored tabsContent">
            <form id="formlist" name="formlist" action="ShowPersonCategorieList" method="post">
                <input type="hidden" name="id" value="$!person.id"/>
                <input type="hidden" name="start" value=""/>
				<input type="hidden" name="limit" value="" />
                <input type="hidden" name="selectAll" value="false"/>
                <input type="hidden" name="selectNone" value="false"/>
				<input type="hidden" id="modified" value="false">
                
                #parse("inc/person-categorie.vm")
    
                <input type="hidden" id="inviteGuestReserve" name="inviteGuestReserve" value="false"/>
                <input type="hidden" id="inviteGuestPartner" name="inviteGuestPartner" value="false"/>
    		</form>
            <script type="text/javascript">
            	function addToGuestList() {
            		htmlConfirm('Soll dieser Gast auf Platz gesetzt werden?', new Array('Ja', 'Nein'), new Array("addToGuestQuestX1('false');", "addToGuestQuestX1('true');"));
            	}
            	
            	function addToGuestQuestX1(answer) {
            		document.getElementById('inviteGuestReserve').value = answer;
            		htmlConfirm('Soll die Partnerin / der Partner mit eingeladen werden?', new Array('Ja', 'Nein'), new Array("addToGuestQuestX2('true');", "addToGuestQuestX2('false');"));
            	}
            	
            	function addToGuestQuestX2(answer) {
            		document.getElementById('inviteGuestPartner').value = answer;
            		htmlWait();
            		
            		var url = '${paths.staticWeb}do/AddPersonToEventGuestList';
            		url += '?list=$!{person.id}';
            		url += '&$!{person.id}-id=${person.id}';
            		url += '&$!{person.id}-select=true';
            		url += '&$!{person.id}-reserve=' + document.getElementById('inviteGuestReserve').value;
            		url += '&$!{person.id}-partner=' + document.getElementById('inviteGuestPartner').value;
            		window.location.href = url;
            	}
            	
				function savePersonCategories() {
					$('<input>').attr({ type: 'hidden', id: 'save', name: 'save' }).appendTo($('#formlist'));
					document.formlist.submit();
				}
				
				function copyPerson() {
					window.location.href = '${paths.staticWeb}do/CopyPerson?id=$!person.id';
            	}
				
				function removePerson() {
            		if (confirm('Aktuelle Person wirklich entfernen?')) {
            			window.location.href = '${paths.staticWeb}do/SearchPerson?doRemove=true&remove&remove-person=true&selectNone=true&list=$!{person.id}&$!{person.id}-select=true';
            		}
            	}
				
            </script>
    	</div>
    </div>

    <span id="buttonPanel-bottom" class="textRight floatRight">
		#if($grants.mayWrite())
			<input type="button" class="mainButton" value="Person speichern" title="Person speichern" onclick="savePersonCategories();"/>
		#end
    	
    	#if($action == "guest")
        	<input type="button" name="cancel" value="Zur Personenliste" title="Zur Personenliste" class="mainButton" onclick="window.location.href='${paths.staticWeb}do/AddPersonToEventList';"/>				
        #elseif($action == "host")
        	<input type="button" name="cancel" value="Zur Personen&uuml;bersicht" title="Zur Personen&uuml;bersicht" class="mainButton" onclick="window.location.href='${paths.staticWeb}do/SetHostToEventList';"/>				
        #elseif($action == "event")
        	<input type="button" name="cancel" value="Zur Personen&uuml;bersicht" title="Zur Personen&uuml;bersicht" class="mainButton" onclick="window.location.href='${paths.staticWeb}do/ShowGuestDetail';"/>				
        #elseif($action == "duplicateSearch")
            <input type="button" name="cancel" value="Zur Dublettensuche" title="Zur Dublettensuche" class="mainButton" onclick="window.location.href='${paths.staticWeb}do/PersonDuplicateSearch';">
        #else
        	<input type="button" name="cancel" value="Zur Personen&uuml;bersicht" title="Zur Personen&uuml;bersicht" class="mainButton" onclick="window.location.href='${paths.staticWeb}do/SearchPerson?action=person';"/>				
        #end				
    </span>
    
    
    #if($navigation)
    	#parse("inc/person-navi.vm")
	#end
	<div class="clear"></div>
</div>

#parse("inc/footer.vm")