#set($activeMenu = "Veranstaltungen")
#set($title = "${placeholderWithTranslation.BROWSER_TITLE_TASKS}")
#set($elementNameSex = "${placeholderWithTranslation.GENDER_TYPE_DELEGATION_FIELD}")
#set($elementNameSingular = "${placeholderWithTranslation.GENERIC_DELEGATION_FIELD_SINGULAR}")
#set($elementNamePlural = "${placeholderWithTranslation.GENERIC_DELEGATION_FIELD_PLURAL}")
#parse("inc/header.vm")
#set($formurl = "SaveDelegationFields")

<script type="text/javascript" src="${paths.staticWeb}scripts/jquery.min.js"></script>

<script type="text/javascript">
	//on document ready
	jQuery(function(){
		toogleOptionalFields();
	});
</script>

<script type="text/javascript">
	function toogleOptionalFields() {
		var types = document.getElementById('typeSelect');
		var selectedValue = types.options[types.selectedIndex].value;

		if (selectedValue == 'Eingabefeld') {
			$("#optionsArea").hide();
		}
		else {
			$("#optionsArea").hide();
		}
	}
</script>

<div id="content_container">

    <div id="breadcrumb" class="textRight marginBottom10">
        <strong>${placeholderWithTranslation.GENERIC_YOU_ARE_HERE}:</strong> <span><a href="${paths.staticWeb}do/">${placeholderWithTranslation.GENERIC_HOME}</a> > ${placeholderWithTranslation.GENERIC_EVENTS_PP} > ${placeholderWithTranslation.veranstaltungbearbeiten}</span>
    </div>

    <h1>${placeholderWithTranslation.veranstaltungbearbeiten}: $!message.plain($event.shortname)</h1>

	#if ($optionalFieldsSummary.createdFields.size()>0 || $optionalFieldsSummary.changedFields.size()>0 || $optionalFieldsSummary.deletedFields.size()>0)
		<div id="message-container" class="msg successmsg">
			#if ($optionalFieldsSummary.createdFields.size()>0)
				<div>
					#if ($optionalFieldsSummary.createdFields.size()>1)
						${placeholderWithTranslation.MESSAGE_REPORT_NUMBER_PART_1} $optionalFieldsSummary.createdFields.size() ${placeholderWithTranslation.zusatzfelder}
					#elseif ($optionalFieldsSummary.createdFields.size()<=1)
						${placeholderWithTranslation.eswurdeeinzusatzfeld}
					#end
					${placeholderWithTranslation.angelegt}.
				</div>
			#end
			#if ($optionalFieldsSummary.changedFields.size()>0)
				<div>
					#if ($optionalFieldsSummary.changedFields.size()>1)
						${placeholderWithTranslation.MESSAGE_REPORT_NUMBER_PART_1} $optionalFieldsSummary.changedFields.size() ${placeholderWithTranslation.zusatzfelder}
					#elseif ($optionalFieldsSummary.changedFields.size()<=1)
						${placeholderWithTranslation.eswurdeeinzusatzfeld}
					#end
					${placeholderWithTranslation.geandert}.
				</div>
			#end
			#if ($optionalFieldsSummary.deletedFields.size()>0)
				<div>
					#if ($optionalFieldsSummary.deletedFields.size()>1)
						${placeholderWithTranslation.MESSAGE_REPORT_NUMBER_PART_1} $optionalFieldsSummary.deletedFields.size() ${placeholderWithTranslation.zusatzfelder}
					#elseif ($optionalFieldsSummary.deletedFields.size()<=1)
						${placeholderWithTranslation.eswurdeeinzusatzfeld}
					#end
					${placeholderWithTranslation.geloscht}.
				</div>
			#end
		</div>
	#end

    <form id="formlist1" name="formlist1" action="$formurl?eventId=$!event.id" method="POST">

        #set($completeEventHeader = false)
        #parse("inc/event-header.vm")

        <div class="marginBottom10 marginTop20 textRight" id="buttonPanel-top">
            <input type="button" class="mainButton" value="${placeholderWithTranslation.zurgasteverwaltung}" name="guestlist"
                   onclick="window.location.href='ShowGuestList?search-event=$!event.id&start=0&selectNone=true';">
        </div>

        <div id="main_content" class="tabs contentBox grayBorder marginBottom10">
            <input type="hidden" name="start" value="">
            <input type="hidden" name="limit" value="" />
            <input type="hidden" name="selectNone" value="true">
            <input type="hidden" name="doRemove" value="true">

            <div id="tabsMain">
                <ul class="gray-gradient"> <!-- Bitte das End-tag der <li>s immer mit in die nÃ¤chste Zeile nehmen (verhindert Mozilla styling bug) -->
                    <li class="inactive noBorder" onclick="window.location.href='ShowEvent?id=$!event.id';">
                        <div>${placeholderWithTranslation.allgemein}</div>
                    </li>
                    <li class="inactive" onclick="window.location.href='${paths.staticWeb}do/ShowEventDoctype?id=$!event.id&selectNone=true';">
                        <div>${placeholderWithTranslation.dokumenttypen}</div>
                    </li>
                    <li class="inactive" onclick="window.location.href='ShowEventTasks?id=$!event.id&selectNone=true';">
                        <div>${placeholderWithTranslation.aufgaben}</div>
                    </li>
                    #if($online-registration.activated)
	                    <li class="active">
	                        <div>${placeholderWithTranslation.zusatzlichepersonendaten}</div>
	                    </li>
	                    <li class="inactive" onclick="window.location.href='ShowEventFunction?id=$!event.id';"><div>${placeholderWithTranslation.GENERIC_FUNCTION_PLURAL}/${placeholderWithTranslation.GENERIC_OFFICIAL_TITLE_PLURAL}</div>
                        </li>
                        <li class="inactive" onclick="window.location.href='ShowEventCategory?id=$!event.id';"><div>${placeholderWithTranslation.GENERIC_CATEGORY_PLURAL}</div>
                        </li>
	                #end
                </ul>
            </div>

            <div class="contentBoxColored tabsContent table">
				<ol class="delegationFields">
					#set($fieldcounter = 0)
	                #foreach($field in $delegationFieldsWithTypeContents )
						<div class="tableRow">
			                #set($fieldcounter = $fieldcounter + 1)
			            	<div class="tableCell width25">
			            		<span>$fieldcounter.</span>
				            	<span>${placeholderWithTranslation.feldbezeichnung}</span>
				                <input type="text" name="optionalField-$field.fkDelegationField" maxlength="25" value="$field.label">
							</div>
							<div class="tableCell width25">
								<span>${placeholderWithTranslation.eingabetyp}</span>
				                <select name="optionalFieldType-$field.fkDelegationField">
								    #foreach($type in $fieldTypes)
				                	   	<option name="optionalFieldtype-$type.id" id="$type.id" #if($field.fkType == $type.id)selected="true"#end>$type.description</option>
								    #end
								</select>
							</div>
						</div>

						<div class="tableRow">
							#if($field.fkType == 2 || $field.fkType == 3)
								<!-- BBB: -->
								#set($fieldvalue = 0)
								#foreach( $typeContent in $field.optionalFieldTypeContents )
									<div class="tableCell width25">
										#set($fieldvalue = $fieldvalue + 1)
										<span>$fieldvalue.</span>
										<input value="$typeContent.content" name="optionalFieldtype-${field.fkDelegationField}_value-${typeContent.id}" />
									</div>
								#end
							#end
				    	</div>
		            #end
				</ol>
			</div>

        <span id="buttonPanel-bottom" class="floatRight">
            #if($grants.mayWrite())
                <input type="submit" name="save" value="${placeholderWithTranslation.veranstaltungspeichern}" class="mainButton"
                	title="${placeholderWithTranslation.veranstaltungspeichern}" onclick="document.getElementById('formlist1').action='$formurl?eventId=$!event.id';" />
            #end
            <input type="reset" name="cancel" value="${placeholderWithTranslation.zurveranstaltungsubersicht}" class="mainButton"
                   onclick="window.location.href='SearchEvent?action=event&search=reset&selectNone=true';" />
        </span>
		</div>
	</form>
    <div class="clear"></div>
</div>


<script type="text/javascript">

$(document).ready(function() {
	if ($showSuccessMessage == true) {
		showSuccess(' ${placeholderWithTranslation.erfolgreichgespeichert} ');
	}
});

</script>

<style>
	.delegationFields {
		margin-left: 10px;
	}

	.delegationFields>li {
		margin:10px;
	}
</style>
#parse("inc/footer.vm")
