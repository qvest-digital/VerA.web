#set($activeMenu = "Veranstaltungen")
#set($title = "E-Mail an Verteiler schreiben: $!message.text($mailinglist.name)")
#set($elementNameSex = "male")
#set($elementNameSingular = "Verteiler")
#set($elementNamePlural = "Verteiler")
#parse("inc/header.vm")

<div id="content_container">

	<div id="breadcrumb" class="textRight marginBottom10">
		<strong>${placeholderWithTranslation.siesindhier}:</strong> <span><a href="${paths.staticWeb}do/" title="${placeholderWithTranslation.ZurStartseite}">${placeholderWithTranslation.Home}</a> > ${placeholderWithTranslation.Personen} > ${placeholderWithTranslation.Verteiler}</span>
	</div>

	<h1>${placeholderWithTranslation.Verteilerversenden}</h1>


	<form id="formlist" name="formlist" action="MailinglistWrite" method="POST">
    	<input type="hidden" id="loaddraft" name="loaddraft" value="false">
    	<input type="hidden" id="savedraft" name="savedraft" value="false">

        #if($errors.size() > 0)
        <vera-warn>
        	$!message.plain($errors.get(0))<br>
        ##	#foreach($error in $errors)
        ##		$error<br>
        ##	#end
        </vera-warn>
        #end

        <input type="hidden" name="mail-id" value="$!mail.id">

    	<div id="main_content" class="contentBoxColored grayBorder marginBottom10">

			<div class="textRight mandatoryText">* = ${placeholderWithTranslation.Pflichtfelder}</div>

			<div class="table width100">
				<div class="tableRow">
					<div class="tableCell width70">
						<h2 class="marginBottom15">${placeholderWithTranslation.EMailschreiben}</h2>

            			<div>
                        	<label for="mail-subject">Betreff</label>
                            <input type="text" id="mail-subject" name="mail-subject" value="$!message.text($mail.subject)">
            			</div>
            			<div>
                        	<label for="mail-text">Text</label>
                        	<textarea id="mail-text" name="mail-text" style="height:200px">$!message.textarea($mail.text)</textarea>
            			</div>
            			<div class="inlineLabel">
                            <label for="platzhalter">${placeholderWithTranslation.Platzhalter}</label>
                        	<select name="platzhalter" id="platzhalter" class="inlineInput autoWidth">
            					<option value="firstname">${placeholderWithTranslation.Vorname}</option>
            					<option value="lastname">${placeholderWithTranslation.Nachname}</option>
             					<option value="salutation">${placeholderWithTranslation.Anrede}</option>
            					<option value="title">${placeholderWithTranslation.AkadTitel}</option>
             					<option value="function">${placeholderWithTranslation.AmtsbezFunktion}</option>
            					<option value="company">${placeholderWithTranslation.Firma/Institution}</option>
            					<option value="street">${placeholderWithTranslation.Stra&szlig;e}</option>
            					<option value="zipcode">${placeholderWithTranslation.PLZ}</option>
            					<option value="city">${placeholderWithTranslation.Ort}</option>
            					<option value="country">${placeholderWithTranslation.Land}</option>
            					<option value="poboxzipcode">${placeholderWithTranslation.PostfachPLZ}</option>
            					<option value="pobox">${placeholderWithTranslation.PostfachNummer}</option>
            					<option value="suffix1">$!message.text($!config.suffix1)</option>
            					<option value="suffix2">$!message.text($!config.suffix2)</option>
            					<option value="phone">${placeholderWithTranslation.Telefon}</option>
            					<option value="fax">${placeholderWithTranslation.Fax}</option>
            					<option value="mobile">${placeholderWithTranslation.Mobil}</option>
            					<option value="email">${placeholderWithTranslation.EMail}</option>
            					<option value="url">${placeholderWithTranslation.www}</option>
            				</select>
                            <input type="button" name="add" value="${placeholderWithTranslation.InTexteinfuegen}" title="${placeholderWithTranslation.PlatzhalterinTexteinfuegen}" class="autoWidth noFloat" onclick="addPlatzhalter(this);">
            			</div>

                        <div id="buttonPanel-bottom" class="textRight">
                           	<input type="button" name="send" value="${placeholderWithTranslation.Senden}" title="${placeholderWithTranslation.Senden}" class="mainButton autoWidth" onclick="document.getElementById('formlist').action='MailinglistSend'; document.getElementById('formlist').submit();">
                           	<input type="reset"  name="clear"  value="${placeholderWithTranslation.Zuruecksetzen}" title="${placeholderWithTranslation.Zuruecksetzen}" class="mainButton autoWidth">
                        </div>
					</div>


					<div class="tableCell width30">
                		<h2 class="marginBottom15">${placeholderWithTranslation.EMailVorlagen}</h2>

                        <div>
            				<label for="mail-draft">${placeholderWithTranslation.VorhandeneVorlagen}</label>
								#if($allMailDraft && $allMailDraft.size() > 0)
                        			<select id="mail-draft" name="mail-draft">
										<option value="0">${placeholderWithTranslation.Bitteauswhaelengt}</option>
										#foreach($draft in $allMailDraft)
                                			<option value="$!draft.id" #if($mail.id && $mail.id == $draft.id) selected #end>$!message.text($!draft.name)</option>
                                		#end
                            		</select>
                        			<input type="button" name="" value="${placeholderWithTranslation.Vorlageladen}" class="autoWidth" title="${placeholderWithTranslation.Vorlageladen}" onclick="document.getElementById('loaddraft').value='true'; document.getElementById('formlist').submit();"/>
									<input type="button" name="send" value="Vorlage entfernen" class="autoWidth" onclick="window.location.href='MailinglistWrite';" title="Keine Vorlage verwenden"/>
								#else
									${placeholderWithTranslation.Es liegen keine Vorlagen vor
								#end

               			</div>
                        <div class="marginTop20">
                        			<label for="mail-name">${placeholderWithTranslation.NeueVorlageName}*</label>
                        			<input type="text" id="mail-name" name="mail-name" value="$!message.text($mail.name)">
                        			<input type="button" name="savedraft" value="${placeholderWithTranslation.NeueVorlagespeichern}" title="${placeholderWithTranslation.NeueVorlagespeichern}" onclick="document.getElementById('savedraft').value='true'; document.getElementById('formlist').submit();" class="autoWidth">
                                    <p class="mandatoryText"><strong>${placeholderWithTranslation.Hinweis}</strong>${placeholderWithTranslation.NeueVorlagenmuessensowohleinenBetreffalsauchTextenthalten}.</p>
                        </div>
					</div>
				</div>
			</div>

		</div>

		<div id="buttonPanel-bottom" class="textRight">
			<input type="button" name="cancel" value="${placeholderWithTranslation.ZurueckzumVerteiler}" title="${placeholderWithTranslation.ZurueckzumVerteiler}" class="mainButton" onclick="window.location.href='ShowMailinglistDetail';">
		</div>
    </form>
</div>

<script type="text/javascript">
	function addPlatzhalter(s) {
		var sel = document.getElementById('platzhalter');
		var text = sel.options[sel.selectedIndex].value;
		if (text.length > 0) {
			insertAtCursor(document.getElementById('mail-text'), '<' + text + '>');
		}
	}
</script>

#parse("inc/footer.vm")
