#set($activeMenu = "Veranstaltungen")
#set($title = "${placeholderWithTranslation.BROWSER_TITLE_EMAIL_WRITE_DISTRIBUTOR}: $!message.text($mailinglist.name)")
#set($elementNameSex = "male")
#set($elementNameSingular = "Verteiler")
#set($elementNamePlural = "Verteiler")
#parse("inc/header.vm")

<div id="content_container">

	<div id="breadcrumb" class="textRight marginBottom10">
		<strong>${placeholderWithTranslation.siesindhier}:</strong> <span><a href="${paths.staticWeb}do/" title="${placeholderWithTranslation.zurstartseite}">${placeholderWithTranslation.home}</a> > ${placeholderWithTranslation.personen} > ${placeholderWithTranslation.verteiler}</span>
	</div>

	<h1>${placeholderWithTranslation.verteilerversenden}</h1>


	<form id="formlist" name="formlist" action="MailinglistWrite" method="POST">
    	<input type="hidden" id="loaddraft" name="loaddraft" value="false">
    	<input type="hidden" id="savedraft" name="savedraft" value="false">

        #if($errors.size() > 0)
        <vera-warn>
        	$!message.plain($errors.get(0))<br>
        ##	#foreach($error in $errors)
        ##		$error<br>
        ##	#end
        </vera-warn>
        #end

        <input type="hidden" name="mail-id" value="$!mail.id">

    	<div id="main_content" class="contentBoxColored grayBorder marginBottom10">

			<div class="textRight mandatoryText">* = ${placeholderWithTranslation.pflichtfelder}</div>

			<div class="table width100">
				<div class="tableRow">
					<div class="tableCell width70">
						<h2 class="marginBottom15">${placeholderWithTranslation.GENERIC_WRITE_EMAIL}</h2>

            			<div>
                        	<label for="mail-subject">Betreff</label>
                            <input type="text" id="mail-subject" name="mail-subject" value="$!message.text($mail.subject)">
            			</div>
            			<div>
                        	<label for="mail-text">Text</label>
                        	<textarea id="mail-text" name="mail-text" style="height:200px">$!message.textarea($mail.text)</textarea>
            			</div>
            			<div class="inlineLabel">
                            <label for="platzhalter">${placeholderWithTranslation.platzhalter}</label>
                        	<select name="platzhalter" id="platzhalter" class="inlineInput autoWidth">
            					<option value="firstname">${placeholderWithTranslation.vorname}</option>
            					<option value="lastname">${placeholderWithTranslation.nachname}</option>
             					<option value="salutation">${placeholderWithTranslation.anrede}</option>
            					<option value="title">${placeholderWithTranslation.akadtitel}</option>
             					<option value="function">${placeholderWithTranslation.amtsbezfunktion}</option>
            					<option value="company">${placeholderWithTranslation.firmainstitution}</option>
            					<option value="street">${placeholderWithTranslation.strasse}</option>
            					<option value="zipcode">${placeholderWithTranslation.plz}</option>
            					<option value="city">${placeholderWithTranslation.ort}</option>
            					<option value="country">${placeholderWithTranslation.land}</option>
            					<option value="poboxzipcode">${placeholderWithTranslation.postfachplz}</option>
            					<option value="pobox">${placeholderWithTranslation.postfachnummer}</option>
            					<option value="suffix1">$!message.text($!config.suffix1)</option>
            					<option value="suffix2">$!message.text($!config.suffix2)</option>
            					<option value="phone">${placeholderWithTranslation.telefon}</option>
            					<option value="fax">${placeholderWithTranslation.fax}</option>
            					<option value="mobile">${placeholderWithTranslation.mobil}</option>
            					<option value="email">${placeholderWithTranslation.email}</option>
            					<option value="url">${placeholderWithTranslation.www}</option>
            				</select>
                            <input type="button" name="add" value="${placeholderWithTranslation.intexteinfuegen}" title="${placeholderWithTranslation.platzhalterintexteinfuegen}" class="autoWidth noFloat" onclick="addPlatzhalter(this);">
            			</div>

                        <div id="buttonPanel-bottom" class="textRight">
                           	<input type="button" name="send" value="${placeholderWithTranslation.senden}" title="${placeholderWithTranslation.senden}" class="mainButton autoWidth" onclick="document.getElementById('formlist').action='MailinglistSend'; document.getElementById('formlist').submit();">
                           	<input type="reset"  name="clear"  value="${placeholderWithTranslation.zuruecksetzen}" title="${placeholderWithTranslation.zuruecksetzen}" class="mainButton autoWidth">
                        </div>
					</div>


					<div class="tableCell width30">
                		<h2 class="marginBottom15">${placeholderWithTranslation.emailvorlagen}</h2>

                        <div>
            				<label for="mail-draft">${placeholderWithTranslation.vorhandenevorlagen}</label>
								#if($allMailDraft && $allMailDraft.size() > 0)
                        			<select id="mail-draft" name="mail-draft">
										<option value="0">${placeholderWithTranslation.bitteauswhaelengt}</option>
										#foreach($draft in $allMailDraft)
                                			<option value="$!draft.id" #if($mail.id && $mail.id == $draft.id) selected #end>$!message.text($!draft.name)</option>
                                		#end
                            		</select>
                        			<input type="button" name="" value="${placeholderWithTranslation.vorlageladen}" class="autoWidth" title="${placeholderWithTranslation.vorlageladen}" onclick="document.getElementById('loaddraft').value='true'; document.getElementById('formlist').submit();"/>
									<input type="button" name="send" value="Vorlage entfernen" class="autoWidth" onclick="window.location.href='MailinglistWrite';" title="Keine Vorlage verwenden"/>
								#else
									${placeholderWithTranslation.esliegenkeinevorlagenvor}
								#end

               			</div>
                        <div class="marginTop20">
                        			<label for="mail-name">${placeholderWithTranslation.neuevorlagename}*</label>
                        			<input type="text" id="mail-name" name="mail-name" value="$!message.text($mail.name)">
                        			<input type="button" name="savedraft" value="${placeholderWithTranslation.neuevorlagespeichern}" title="${placeholderWithTranslation.neuevorlagespeichern}" onclick="document.getElementById('savedraft').value='true'; document.getElementById('formlist').submit();" class="autoWidth">
                                    <p class="mandatoryText"><strong>${placeholderWithTranslation.GENERIC_TOOLTIP}</strong>${placeholderWithTranslation.neuevorlagenmuessensowohleinenbetreffalsauchtextenthalten}.</p>
                        </div>
					</div>
				</div>
			</div>

		</div>

		<div id="buttonPanel-bottom" class="textRight">
			<input type="button" name="cancel" value="${placeholderWithTranslation.zurueckzumverteiler}" title="${placeholderWithTranslation.zurueckzumverteiler}" class="mainButton" onclick="window.location.href='ShowMailinglistDetail';">
		</div>
    </form>
</div>

<script type="text/javascript">
	function addPlatzhalter(s) {
		var sel = document.getElementById('platzhalter');
		var text = sel.options[sel.selectedIndex].value;
		if (text.length > 0) {
			insertAtCursor(document.getElementById('mail-text'), '<' + text + '>');
		}
	}
</script>

#parse("inc/footer.vm")
