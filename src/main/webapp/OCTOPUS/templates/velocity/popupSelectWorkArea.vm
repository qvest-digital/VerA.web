## Popup zur Auswahl eines oder keines Arbeitsbereiches
## cklein
## 2008-02-28

<html>

<head>
	<title>${placeholderWithTranslation.Arbeitsbereiche}</title>
	<link rel="stylesheet" type="text/css" href="${paths.staticWeb}styles/default.css" media="all" />
	<link rel="stylesheet" type="text/css" href="${paths.staticWeb}styles/style.css" media="all" />
	<script type="text/javascript" src="${paths.staticWeb}scripts/jquery.min.js"></script>
	<script type="text/javascript" src="${paths.staticWeb}scripts/utils.js"></script>
	<script type="text/javascript" src="${paths.staticWeb}scripts/dhtml-popup.js"></script>

	<script type="text/javascript">
		var showDeleteAllocate = function () {
    		var selectionOfOption = $('option[name$="nix"]:selected');
    			if(selectionOfOption.length === 1) {
    				var msg ='<span>${placeholderWithTranslation.WaehlenSiebittezunaechsteinenArbeitsbereichaus}</span>';
					showWarning(msg);
    			}else {
    				#if( $count == 1 )
						showAllocateAssign('${placeholderWithTranslation.WollenSiediesePersonbzwdiesenGastdenausgewaehltenArbeitsbereichzuordnen}',
						function () { // Ja
                           	var form = window.opener.document.forms[ "formlist" ];
                	       	 var input = window.document.createElement('input');
                	       	 input.type = 'hidden';
                	       	 input.name = 'workareaAssigned';
                	       	 input.value = 'assign';
                	       	 form.appendChild(input);
                	       	 form.submit();
						}, function () { //nein
							showSuccess('${placeholderWithTranslation.EswurdekeinArbeitsbereichzugeordnet}');
						});
        			#else
        				showAllocateAssign('${placeholderWithTranslation.WollenSiediesenPersonenbzwdiesenGaestedenausgewaehltenArbeitsbereichzuordnen}',
						function () { // Ja
							var form = window.opener.document.forms[ "formlist" ];
                	       	 var input = window.document.createElement('input');
                	       	 input.type = 'hidden';
                	       	 input.name = 'workareaAssigned';
                	       	 input.value = 'assign';
                	       	 form.appendChild(input);
                	       	 form.submit();
						}, function () { //nein
							showSuccess('${placeholderWithTranslation.EswurdenkeineArbeitsbereichzugeordnet}');
						});
        			#end
    			};
		};
		var showDeleteAllocateRemove = function() {
			var selectionOfOption = $('option[name$="nix"]:selected');
    			if(selectionOfOption.length === 1) {
    				var msg ='<span>${placeholderWithTranslation.WaehlenSiebittezunaechsteinenArbeitsbereichaus}</span>';
					showWarning(msg);
    			}else {
    				#if( $count == 1 )
						showAllocateRemove('${placeholderWithTranslation.WollenSiedieZuordnungdieserPersonbzwdiesemGastzumausgewaehltenArbeitsbereichaufheben}',
						function () { // Ja
                           	var form = window.opener.document.forms[ "formlist" ];
                	       	 var input = window.document.createElement('input');
                	       	 input.type = 'hidden';
                	       	 input.name = 'workareaAssigned';
                	       	 input.value = 'unassign';
                	       	 form.appendChild(input);
                	       	 form.submit();
						}, function () { //nein
							showSuccess('${placeholderWithTranslation.EswurdekeinArbeitsbereichaufgehoben}');
						});
        			#else
						showAllocateRemove('${placeholderWithTranslation.WollenSiedieZuordnungvonPersonenbzwGaestenzumausgewaehltenArbeitsbereichaufheben}',
						function () { // Ja
							var form = window.opener.document.forms[ "formlist" ];
                	       	 var input = window.document.createElement('input');
                	       	 input.type = 'hidden';
                	       	 input.name = 'workareaAssigned';
                	       	 input.value = 'unassign';
                	       	 form.appendChild(input);
                	       	 form.submit();
						}, function () { //nein
							showSuccess('${placeholderWithTranslation.EswurdekeinArbeitsbereichaufgehoben}');
						});
        			#end
    			};
		};

		// Funktion um ausgewählte Option : Zuweisen / Entfernen und Abbrechen zu überprüfen und dementspreche abfragen zu implementieren
		$(function () {
            $('#button\\.execute').click(function (e) {
                var selectText = $("input:button[name$='checkboxForSelection'] ").text();

				if (selectText == "${placeholderWithTranslation.Zuweisen}") {
					showDeleteAllocate();
				}else if (selectText == "${placeholderWithTranslation.Entfernen}") {
            		selectedActionRemove();
				}else if (selectText == "${placeholderWithTranslation.Abbrechen}") {
					selectedActionCancel();
				}
			});
		});

		var oldState = { workareaId : null, actionName : null };

		function selected( elt )
		{
			window.opener.document.forms[ "formlist" ].elements[ "workareaAssignmentId" ].value = elt.options[ elt.selectedIndex ].value;
			window.opener.document.forms[ "formlist" ].elements[ "workareaAssignmentAction" ].value = "${assignmentAction}";
		}

		function restore()
		{
			window.opener.document.forms[ "formlist" ].elements[ "workareaAssignmentId" ].value = oldState.workareaId;
			window.opener.document.forms[ "formlist" ].elements[ "workareaAssignmentAction" ].value = oldState.actionName;
		}

		function initialize()
		{
			oldState.workareaId = window.opener.document.forms[ "formlist" ].elements[ "workareaAssignmentId" ].value;
			oldState.actionName = window.opener.document.forms[ "formlist" ].elements[ "workareaAssignmentAction" ].value;
		}

		function send()
		{
#if( $assignmentAction == "assign" )
#if( $count == 1 )
			##doit = confirm( "${placeholderWithTranslation.WollenSiediesePersonbzwdiesenGastdemausgewaehltenArbeitsbereichzuordnen}" );
			doit = true;

#else
			##doit = confirm( "${placeholderWithTranslation.WollenSiePersonenbzwGaestedemausgewaehltenArbeitsbereichzuordnen}" );
			doit = true;
#end
#else
#if ( $count == 1 )
			##doit = confirm( "${placeholderWithTranslation.WollenSiedieZuordnungdieserPersonbzwdiesemGastzumausgewaehltenArbeitsbereichaufheben}" );
			doit = true;
#else
			##doit = confirm( "${placeholderWithTranslation.WollenSiedieZuordnungvonPersonenbzwGaestenzumausgewaehltenArbeitsbereichaufheben}" );
			doit = true;
#end
#end
			if ( doit )
			{
				window.opener.document.forms[ "formlist" ].submit();
			}
		}

		function adjustSize()
		{
			var elt = document.getElementById( "workarea" );
			var minWidth = 400;
			var newWidth = elt ? elt.offsetWidth : minWidth;
			if ( newWidth < minWidth )
			{
				newWidth = minWidth;
			}
			if( window.innerWidth < newWidth )
			{
				// add fixed margins + paddings
				newWidth += 100;
			}
			window.resizeTo( newWidth, document.body.offsetHeight + 20 );
		}
	</script>
</head>

<body onload="adjustSize();" id="popUp">

<form>

<div class="contentBoxColored grayBorder">
		<h1>${placeholderWithTranslation.WaehlenSieeinenArbeitsbereichauswelchenSie}
	#if( $assignmentAction == "assign" )
		${placeholderWithTranslation.zuweisen}
	#else
		${placeholderWithTranslation.entfernen}
	#end
	    ${placeholderWithTranslation.moechten}</h1>

	#if( $allWorkArea.size() > 0 )
		<label for="workarea">${placeholderWithTranslation.Arbeitsbereich}</label>
		<select name="workarea" id="workarea" onChange="selected(this);">
		<option name="nix" value="">
	#if( $assignmentAction == "unassign" )
		<option name="Entfernen" value="0">${placeholderWithTranslation.Alleentfernen}
	#end
		#foreach( $workarea in $allWorkArea )
		<option name="arbeitsbereich" value="${workarea.id}">$!message.plain(${workarea.name})
		#end
		</select>
	#else
	    ${placeholderWithTranslation.SiehabenkeineArbeitsbereichekonfiguriertDiesekoennenSieimAdministrationsbereichunterdemPunkt} <em>${placeholderWithTranslation.Arbeitsbereiche}</em> ${placeholderWithTranslation.definieren}
	#end

	<div class="textRight marginTop5" id="buttonPanel-bottom">
		<input type="button" name="checkboxForSelection" value="${placeholderWithTranslation.Abbrechen}" onClick="restore();closePopup();">
		#if( $assignmentAction == "assign" && $allWorkArea.size() > 0 )
				<input type="button"  name="checkboxForSelection" value="${placeholderWithTranslation.Zuweisen}" onClick="showDeleteAllocate();">
		#elseif ( $allWorkArea.size() > 0 )
				<input type="button"  name="checkboxForSelection" value="${placeholderWithTranslation.Entfernen}" onClick="showDeleteAllocateRemove();">
		#end
	</div>
</div>
</form>

<vera-info>
	${placeholderWithTranslation.SiehabenPersonenausgewaehltAbhaengigvonderAnzahlderausgewaehltenPersonenkanndieAktioneinegewisseZeitinAnspruchnehmen}
</vera-info>


</body>
</html>
