#set($activeMenu = "${placeholderWithTranslation.Personen}")
#if($person && $person)
 #set($title = "${placeholderWithTranslation.Personbearbeiten}: $!message.plain($person.MainLatin.SaveAs)")
#else
 #set($title = "${placeholderWithTranslation.NeuePersonanlegen}")
#end

#set($elementNameSex = "male")
#set($elementNameSingular = "${placeholderWithTranslation.Dokumenttyp}")
#set($elementNamePlural = "${placeholderWithTranslation.Dokumenttypen}")
#if($personTab == "1" || $personTab == "2")
  ## impelemented to show message when person are changed
  #set($elementNameSex = "female")
  #set($elementNameSingular = "${placeholderWithTranslation.Person}")
  #set($elementNamePlural = "${placeholderWithTranslation.Personen}")
#end
#parse("inc/header.vm")

#set($searchTask = $octopusRequest.searchTask)

<div id="breadcrumb" class="textRight marginBottom10">
    <strong>${placeholderWithTranslation.siesindhier}</strong> <span><a href="${paths.staticWeb}do/" title="${placeholderWithTranslation.ZurStartseite}">Home</a> > ${placeholderWithTranslation.Personen} > #if($person && $person.id)${placeholderWithTranslation.Personbearbeiten}#else ${placeholderWithTranslation.Personanlegen}#end</span>
</div>

<h1>$title</h1>



<div id="content_container">


    #parse("inc/person-header.vm")

    <div id="main_content" class="tabs contentBox grayBorder marginBottom10">


        <div id="tabsMain">
            <ul class="gray-gradient"> <!-- Bitte das End-tag der <li>s immer mit in die nÃ¤chste Zeile nehmen (verhindert Mozilla styling bug) -->
                <li class="inactive" id="${placeholderWithTranslation.personendaten}"><div>${placeholderWithTranslation.Personendaten}</div>
                </li><li class="inactive" id="${placeholderWithTranslation.anschriften}"><div>${placeholderWithTranslation.Anschriften}</div>
                </li><li class="active" id="${placeholderWithTranslation.dokumenttypen}"><div>${placeholderWithTranslation.Dokumenttypen}</div>
                </li><li class="inactive" id="${placeholderWithTranslation.Kategorien}"><div>${placeholderWithTranslation.Kategorien}</div></li>
            </ul>
        </div>



        <div class="contentBoxColored tabsContent">
        #if($persondoctype)
        #parse("inc/person-doctype2.vm")
        #else
        #parse("inc/person-doctype.vm")
        #end
        </div>




    </div>

                <span id="buttonPanel-bottom" class="textRight floatRight">
		#if($grants.mayWrite())
             <input id="buttonSavePerson" class="mainButton" type="button" value="${placeholderWithTranslation.Personspeichern}" title="${placeholderWithTranslation.Personspeichern}">
		#end

    	#if($action == "guest")
        	<input type="button" name="cancel" value="${placeholderWithTranslation.ZurPersonenliste${placeholderWithTranslation." title="${placeholderWithTranslation.ZurPersonenliste}" class="mainButton" onclick="window.location.href='${paths.staticWeb}do/AddPersonToEventList';"/>
        #elseif($action == "host")
        	<input type="button" name="cancel" value="${placeholderWithTranslation.ZurPersonenuebersicht}" title="${placeholderWithTranslation.ZurPersonenuebersicht}" class="mainButton" onclick="window.location.href='${paths.staticWeb}do/SetHostToEventList';"/>
        #elseif($action == "event")
        	<input type="button" name="cancel" value="${placeholderWithTranslation.ZurPersonenuebersicht}" title="${placeholderWithTranslation.ZurPersonenuebersicht}" class="mainButton" onclick="window.location.href='${paths.staticWeb}do/ShowGuestDetail';"/>
			#if($octopusRequest.show && $octopusRequest.show == 'doctype')
				<input type="button" name="cancel" class="mainButton" value="${placeholderWithTranslation.ZurueckzurVeranstaltung}" title="${placeholderWithTranslation.ZurueckzurVeranstaltung}" onclick="if (checkModified()) { window.location.href='${paths.staticWeb}do/ShowGuestDoctype'; }">
			#else
				<input type="button" name="cancel" class="mainButton" value="${placeholderWithTranslation.ZurueckzurVeranstaltung}" title="${placeholderWithTranslation.ZurueckzurVeranstaltung}" onclick="if (checkModified()) { window.location.href='${paths.staticWeb}do/ShowGuestDetail?tab=$!octopusRequest.tab'; }">
			#end
		#elseif($action == "duplicateSearch")
            <input type="button" name="cancel" value="${placeholderWithTranslation.ZurDublettensuche}" title="${placeholderWithTranslation.ZurDublettensuche}" class="mainButton" onclick="window.location.href='${paths.staticWeb}do/PersonDuplicateSearch?selectNone=true';">
        #elseif($searchTask && $searchTask == "personSearchTask")
            <input type="button" name="cancel" class="mainButton" value="${placeholderWithTranslation.ZurckzumSuchergebnis}" title="${placeholderWithTranslation.ZurckzumSuchergebnis}" onclick="if (checkModified()) { window.location.href='${paths.staticWeb}do/SearchPerson?action=person&searchTask=personSearchTask&selectNone=true'; }">
        #else
            <input type="button" name="cancel" class="mainButton" value="${placeholderWithTranslation.ZurPersonenuebersicht}" title="${placeholderWithTranslation.ZurPersonenuebersicht}" onclick="if (checkModified()) { window.location.href='${paths.staticWeb}do/SearchPerson?action=person&selectNone=true'; }">
		#end
    </span>

    #if($navigation)
    #parse("inc/person-navi.vm")
    #end
    <div class="clear"></div>

</div>




<input type="hidden" name="searchTask" value="$!searchTask"/>
<input type="hidden" id="modified" value="false">
<input type="hidden" id="inviteGuestReserve" name="inviteGuestReserve" value="false">
<input type="hidden" id="inviteGuestPartner" name="inviteGuestPartner" value="false">
<script type="text/javascript">
	function addToGuestList() {
		htmlConfirm('${placeholderWithTranslation.SolldieserGastaufPlatzgesetztwerden}', new Array('${placeholderWithTranslation.Ja}', '${placeholderWithTranslation.Nein}'), new Array("addToGuestQuestX1('false');", "addToGuestQuestX1('true');"));
	}

	function addToGuestQuestX1(answer) {
		document.getElementById('inviteGuestReserve').value = answer;
		htmlConfirm('${placeholderWithTranslation.SolldiePartnerinderPartnermiteingeladenwerden}', new Array('${placeholderWithTranslation.Ja}', '${placeholderWithTranslation.Nein}'), new Array("addToGuestQuestX2('true');", "addToGuestQuestX2('false');"));
	}

	function addToGuestQuestX2(answer) {
		document.getElementById('inviteGuestPartner').value = answer;
		htmlWait();

		var url = '${paths.staticWeb}do/AddPersonToEventGuestList';
		url += '?list=$!{person.id}';
		url += '&$!{person.id}-id=${person.id}';
		url += '&$!{person.id}-select=true';
		url += '&$!{person.id}-reserve=' + document.getElementById('inviteGuestReserve').value;
		url += '&$!{person.id}-partner=' + document.getElementById('inviteGuestPartner').value;
		window.location.href = url;
	}

	function copyPerson() {
		window.location.href = '${paths.staticWeb}do/CopyPerson?id=$!person.id';
	}

	function removePerson() {
		if (confirm('${placeholderWithTranslation.AktuellePersonwirklichentfernen}')) {
			window.location.href = '${paths.staticWeb}do/SearchPerson?doRemove=true&remove&remove-person=true&selectNone=true&list=$!{person.id}&$!{person.id}-select=true';
		}
	}

	#if(!$grants.mayWrite())
	disableForm(document.getElementById('formlist'));
	#end
	disableFormInput(document.getElementById('person-expire'));
	disableFormCheckbox(document.getElementById('person-iscompany'));
	hideBlock(document.getElementById('show-expire'));
</script>

#parse("inc/footer.vm")


<script type="text/javascript">


    $(function () {
        $('li#personendaten').click(function () {
            window.location.href = '${paths.staticWeb}do/ShowPerson?id=$!person.id&searchTask=$!searchTask&personTab=1'+getGuestTabId();
        });
        $('li#anschriften').click(function () {
            window.location.href = '${paths.staticWeb}do/ShowPerson?id=$!person.id&searchTask=$!searchTask&personTab=2'+getGuestTabId();
        });
        $('li#Kategorien').click(function () {
            window.location.href = '${paths.staticWeb}do/ShowPersonCategorieList?id=$!person.id&searchTask=$!searchTask'+getGuestTabId();
        });

        var save = $('input[name=save]');
        $('#buttonSavePerson').click(function () {
            save.trigger('click');
        });
    });

</script>
