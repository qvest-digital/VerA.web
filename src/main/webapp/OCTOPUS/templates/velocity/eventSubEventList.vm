#set($activeMenu = "Veranstaltungen")
#set($title = "${placeholderWithTranslation.BROWSER_TITLE_EVENT_EDIT}: $!message.plain($event.shortname)")
#set($elementNameSex = "male")
#set($elementNameSingular = "Dokumenttyp")
#set($elementNamePlural = "Dokumenttypen")

##Values in per cent for table columns width
	#set($column0 = 3)
	#set($column1 = 5)
	#set($column2 = 25)
	#set($column3 = 10)
	#set($column4 = 10)
	#set($column5 = 25)
	#set($column6 = 25)

#parse("inc/header.vm")

<div id="content_container">

	<div id="breadcrumb" class="textRight marginBottom10">
		<strong>${placeholderWithTranslation.siesindhier}:</strong> <span><a href="${paths.staticWeb}do/" title="${placeholderWithTranslation.zurstartseite}">${placeholderWithTranslation.home}</a> > ${placeholderWithTranslation.veranstaltungen} > ${placeholderWithTranslation.veranstaltungbearbeiten}</span>
	</div>

	<h1>${placeholderWithTranslation.veranstaltungbearbeiten}: $!message.plain($event.shortname)</h1>


	#set($completeEventHeader = false)
	#parse("inc/event-header.vm")

	<form id="formlist" name="formlist" action="ShowEventDoctype" method="POST" onsubmit="htmlWait();">
		<input type="hidden" name="id" value="$!event.id"/>
		<input type="hidden" name="start" value=""/>
		<input type="hidden" name="limit" value=""/>
		<input type="hidden" name="selectNone" value="true"/>
		<input type="hidden" name="doInsert" value="true"/>
		<input type="hidden" name="doUpdate" value="false"/>
		<input type="hidden" name="doRemove" value="true"/>

        <div class="textRight marginBottom10 marginTop20" id="buttonPanel-top">
            <input type="button" class="mainButton" value="${placeholderWithTranslation.zurgasteverwaltung}" name="guestlist" onclick="window.location.href='ShowGuestList?search-event=$!event.id&start=0&selectNone=true';"/>
        </div>

        <!-- Bitte das End-tag der <li>s immer mit in die nächste Zeile nehmen (verhindert Mozilla styling bug) -->
        <div id="main_content" class="tabs contentBox grayBorder marginBottom10">
            <div id="tabsMain" class="event">
                ##First row
                <ul class="gray-gradient" vera-tab-group>
                    <li class="inactive" onclick="window.location.href='ShowEvent?id=$!event.id';">
                        <div>Allgemein</div>
                    </li>
                   <li class="inactive"
                        onclick="window.location.href='${paths.staticWeb}do/ShowEventDoctype?id=$!event.id&selectNone=true';" class="noBorder">
                        <div>${placeholderWithTranslation.dokumenttypen}</div>
                    </li>
                    <li class="inactive" onclick="window.location.href='ShowEventTasks?id=$!event.id&selectNone=true';">
                        <div>Aufgaben</div>
                    </li>
                    #if($online-registration.activated)
                        <li class="inactive" onclick="window.location.href='${paths.staticWeb}do/ShowDelegationFields?eventId=$!event.id'">
                            <div>${placeholderWithTranslation.zusatzlichepersonendaten}</div>
                        </li>
                        <li class="inactive" onclick="window.location.href='ShowEventFunction?id=$!event.id';">
                            <div>${placeholderWithTranslation.GENERIC_FUNCTION_PLURAL}/${placeholderWithTranslation.GENERIC_OFFICIAL_TITLE_PLURAL}</div>
                        </li>
                        <li class="inactive" onclick="window.location.href='ShowEventCategory?id=$!event.id';">
                            <div>${placeholderWithTranslation.kategorien}</div>
                        </li>
                    #end
                </ul>
                ##Second row
                #if($online-registration.activated)
                    <ul class="gray-gradient" vera-tab-group>
                        #if($event.eventtype == "Offene Veranstaltung")
                            <li class="inactive" onclick="window.location.href='ShowEventPrecondition?id=$!event.id';">
                                <div>${placeholderWithTranslation.GENERIC_PRECONDITION_PLURAL}</div>
                            </li>
                        #end
                        <li class="active">
                            <div>${placeholderWithTranslation.GENERIC_SUBEVENT_PLURAL}</div>
                        </li>
                    </ul>
                #end
            </div>






	<div style="height:20px;"></div>
	#if($action == "guest")
	<vera-info>
		${placeholderWithTranslation.bitteklickensieeinederaufgelistetenveranstaltungenanumdiegastezuubernehmen}
	</vera-info>
	#end

	#if($action == "addperson")
	<vera-info>
		${placeholderWithTranslation.bitteklickensieeinederaufgelistetenveranstaltungenanumdiepersondieserveranstaltungzuzuordnen}
	</vera-info>
	#end


	<form id="formlist" name="formlist" action="$formurl" method="POST">
		<input type="hidden" name="start" value="">
		<input type="hidden" name="limit" value="" />

		<!-- Hidden value to save the information if the list view was shown after event search.
		This is specially needed after one of the paging buttons was pressed to save this information.-->
		#if($searchTask)
			<input type="hidden" name="searchTask" value="">
		#end

		<input type="hidden" name="selectNone" value="true">
		<input type="hidden" name="doRemove" value="true">

		#if($listerrors && $listerrors.size() > 0)
			<vera-warn>
				<strong>${placeholderWithTranslation.loschenvonveranstaltungenistnichtmoglich}</strong><br>
				<ul style="margin: 0px 0px 0px -10px;">

				#if($listerrors.size() > 5)
					#set($show = 5)
				#else
					#set($show = $listerrors.size())
				#end

				#foreach($error in $listerrors)
					#if($velocityCount <= $show)
						<li style="margin: 5px 0px 0px 0px;">$error</li>
					#end
				#end

				#if($listerrors.size() > $show)
					#set($drop = $listerrors.size() - $show)
						<li style="margin: 5px 0px 0px 0px;"><em>... $drop ${placeholderWithTranslation.weiteremeldungen}</em></li>
				#end
				</ul>
			</vera-warn>

		#elseif($listquestions && $listquestions.size() > 0)
			<vera-confirm>
				<strong>${placeholderWithTranslation.bittebestatigensiedasloschendermarkiertenveranstaltungen}</strong><br><br>
				#foreach($quest in $listquestions.entrySet())
						<span class="notBold"><input type="hidden" name="$quest.key" value="true">$quest.value</span>
					#set($save = true)
				#end
				<br>
				#foreach($quest in $listquestions2.entrySet())
						<input type="hidden" name="$quest.key" value="true">$quest.value
					#set($save = true)
				#end
				<br>
				<br>

				#if($save)
					<div class="floatRight">
					<input type="submit" class="button" name="remove" value="${placeholderWithTranslation.loschen}" title="${placeholderWithTranslation.markierteveranstaltungloschen}">
				#end
				<input type="button" id="button.remove-cancel" name="cancel" value="${placeholderWithTranslation.abbrechen}"/>
				</div>
			</vera-confirm>
		#end

		<!-- No need to show table and buttons in case of no results -->
		#if ($listparam.count == 0)
			#if($grants.mayWrite() && !$searchTask)
				<div id="" class="buttonPanel-top textRight marginBottom10">
					<input type="button" name="" value="${placeholderWithTranslation.neueunterveranstaltunganlegen}" class="mainButton" onclick="window.location.href='CreateSubEvent?action=subEvent';"/>
				</div>
			#end
			<div class="contentBoxColored grayBorder marginBottom20">
				${placeholderWithTranslation.eswurdenkeineeintragegefunden}
			</div>

		#else

			#if($action != "guest" && $action != "addperson")
			<span id="actionPanel" class="inlineLabel">
				#if(($action != "guest" || $action != "addperson") && $grants.mayWrite())
					<strong>${placeholderWithTranslation.markierteunterveranstaltungen}</strong>
					<input type="button" id="button.remove" name="button.remove" value="${placeholderWithTranslation.loschen}" title="${placeholderWithTranslation.markierteunterveranstaltungenloschen}"/>
				#else &nbsp; #end
			</span>
			#end

			#if($action != "guest" && $action != "addperson" && !$searchTask )
				<span id="" class="buttonPanel-top textRight floatRight">
					<input type="button" name="" value="${placeholderWithTranslation.unterveranstaltungsuchen}" class="mainButton" onclick="window.location.href='ShowEventSearch?action=event';"/>
					#if($grants.mayWrite())
						<input type="button" name="" value="${placeholderWithTranslation.neueunterveranstaltunganlegen}" class="mainButton" onclick="window.location.href='CreateSubEvent?id=$!event.id&action=subEvent';"/>
					#end
				</span>
			#end

				#foreach($bean in $list)
					<input type="hidden" name="list" value="$bean.id">
				#end

				<table class="fixed">
					##Set column size
					<col width="$column0%" />
    				<col width="$column1%" />
    				<col width="$column2%" />
    				<col width="$column3%" />
    				<col width="$column4%" />
    				<col width="$column5%" />
    				<col width="$column6%" />


					<tr>
						#if($action != "guest" && $action != "addperson" && $grants.mayWrite())
							<th class="textCenter smallCell"><input type="checkbox" name="toggleAllSelect" id="toggleAllSelect" title="Alle (de)markieren" #if($listselection.size() == $list.size()) checked#end/></th>
						#end

						<th class="smallCell textCenter">${placeholderWithTranslation.id}</th>
						<th>${placeholderWithTranslation.GENERIC_NAME}</th>
						<th class="smallCell textCenter">${placeholderWithTranslation.beginn}</th>
						<th class="smallCell textCenter">${placeholderWithTranslation.ende}</th>
						<th>${placeholderWithTranslation.gastgeber}</th>
						<th>${placeholderWithTranslation.veranstaltungsort}</th>
					</tr>

					#foreach($bean in $list)

						#set($offset = $listparam.start + $velocityCount)
						<tr>

							#if($action == "guest")

								<td onclick="window.location.href='AddEventToEventGuestList?id=$!{bean.id}&selectNone=true';" class="textCenter"><input type="hidden" name="${bean.id}-id" value="$bean.id">$!{bean.id}</td>
								<td onclick="window.location.href='AddEventToEventGuestList?id=$!{bean.id}&selectNone=true';">$!message.plain($bean.shortname)</td>

								#if ($bean.begin.Seconds == 30)
									<td onclick="window.location.href='AddEventToEventGuestList?id=$!{bean.id}&selectNone=true';" class="textCenter">$!message.date("DATE", $bean.begin)</td>
								#else
									<td onclick="window.location.href='AddEventToEventGuestList?id=$!{bean.id}&selectNone=true';" class="textCenter">$!message.date("DATE_TIME", $bean.begin) Uhr</td>
								#end

								#if($bean.end)
									#if ($bean.end.Seconds == 30)
										<td onclick="window.location.href='AddEventToEventGuestList?id=$!{bean.id}&selectNone=true';" class="textCenter">$!message.date("DATE", $bean.end)</td>
									#else
										<td onclick="window.location.href='AddEventToEventGuestList?id=$!{bean.id}&selectNone=true';" class="textCenter">$!message.date("DATE_TIME", $bean.end) Uhr</td>
									#end
								#else
									<td onclick="window.location.#set($activeMenu = "Veranstaltungen")
#set($title = "${placeholderWithTranslation.BROWSER_TITLE_EVENT_EDIT}: $!message.plain($event.shortname)")
#set($elementNameSex = "male")
#set($elementNameSingular = "Dokumenttyp")
#set($elementNamePlural = "Dokumenttypen")

##Values in per cent for table columns width
#set($column0 = 3)
#set($column1 = 5)
#set($column2 = 92)

#parse("inc/header.vm")

<div id="content_container">

	<div id="breadcrumb" class="textRight marginBottom10">
		<strong>${placeholderWithTranslation.siesindhier}:</strong> <span><a href="${paths.staticWeb}do/" title="${placeholderWithTranslation.zurstartseite}">${placeholderWithTranslation.home}</a> > ${placeholderWithTranslation.veranstaltungen} > ${placeholderWithTranslation.veranstaltungbearbeiten}</span>
	</div>

	<h1>${placeholderWithTranslation.veranstaltungbearbeiten}: $!message.plain($event.shortname)</h1>


	#set($completeEventHeader = false)
	#parse("inc/event-header.vm")

	<form id="formlist" name="formlist" action="ShowEventDoctype" method="POST" onsubmit="htmlWait();">
		<input type="hidden" name="id" value="$!event.id"/>
		<input type="hidden" name="start" value=""/>
		<input type="hidden" name="limit" value=""/>
		<input type="hidden" name="selectNone" value="true"/>
		<input type="hidden" name="doInsert" value="true"/>
		<input type="hidden" name="doUpdate" value="false"/>
		<input type="hidden" name="doRemove" value="true"/>

        <div class="textRight marginBottom10 marginTop20" id="buttonPanel-top">
            <input type="button" class="mainButton" value="${placeholderWithTranslation.zurgasteverwaltung}" name="guestlist" onclick="window.location.href='ShowGuestList?search-event=$!event.id&start=0&selectNone=true';"/>
        </div>

        <!-- Bitte das End-tag der <li>s immer mit in die nächste Zeile nehmen (verhindert Mozilla styling bug) -->
        <div id="main_content" class="tabs contentBox grayBorder marginBottom10">
            <div id="tabsMain" class="event">
                ##First row
                <ul class="gray-gradient" vera-tab-group>
                    <li class="inactive" onclick="window.location.href='ShowEvent?id=$!event.id';">
                        <div>Allgemein</div>
                    </li>
                   <li class="inactive"
                        onclick="window.location.href='${paths.staticWeb}do/ShowEventDoctype?id=$!event.id&selectNone=true';" class="noBorder">
                        <div>${placeholderWithTranslation.dokumenttypen}</div>
                    </li>
                    <li class="inactive" onclick="window.location.href='ShowEventTasks?id=$!event.id&selectNone=true';">
                        <div>Aufgaben</div>
                    </li>
                    #if($online-registration.activated)
                        <li class="inactive" onclick="window.location.href='${paths.staticWeb}do/ShowDelegationFields?eventId=$!event.id'">
                            <div>${placeholderWithTranslation.zusatzlichepersonendaten}</div>
                        </li>
                        <li class="inactive" onclick="window.location.href='ShowEventFunction?id=$!event.id';">
                            <div>${placeholderWithTranslation.GENERIC_FUNCTION_PLURAL}/${placeholderWithTranslation.GENERIC_OFFICIAL_TITLE_PLURAL}</div>
                        </li>
                        <li class="inactive" onclick="window.location.href='ShowEventCategory?id=$!event.id';">
                            <div>${placeholderWithTranslation.kategorien}</div>
                        </li>
                    #end
                </ul>
                ##Second row
                #if($online-registration.activated)
                    <ul class="gray-gradient" vera-tab-group>
                        #if($event.apply_without_precondition && $event.apply_without_precondition == true)
                        <li class="inactive" onclick="window.location.href='ShowEventPrecondition?id=$!event.id';">
                            <div>${placeholderWithTranslation.GENERIC_PRECONDITION_PLURAL}</div>
                        </li>
                        #end
                        <li class="active">
                            <div>${placeholderWithTranslation.subEvents}</div>
                        </li>
                    </ul>
                #end
            </div>


									href='AddEventToEventGuestList?id=$!{bean.id}&selectNone=true';" class="textCenter"></td>
								#end

								<td onclick="window.location.href='AddEventToEventGuestList?id=$!{bean.id}&selectNone=true';">$!message.plain($bean.hostname)</td>
								<td onclick="window.location.href='AddEventToEventGuestList?id=$!{bean.id}&selectNone=true';">
									#foreach($location in $allLocation)
										#if($location.get("id") == $bean.location)
											$!message.plain($location.get("name"))
										#end
									#end
								</td>

							#elseif($action == "addperson")

								<td onclick="window.location.href='AddPersonToEventDetail?event-id=$!{bean.id}&action=person';" class="textCenter"><input type="hidden" name="${bean.id}-id" value="$bean.id">$!{bean.id}</td>
								<td onclick="window.location.href='AddPersonToEventDetail?event-id=$!{bean.id}&action=person';">$!message.plain($bean.shortname)</td>

								#if ($bean.begin.Seconds == 30)
									<td onclick="window.location.href='AddPersonToEventDetail?event-id=$!{bean.id}&action=person';" class="textCenter">$!message.date("DATE", $bean.begin)</td>
								#else
									<td onclick="window.location.href='AddPersonToEventDetail?event-id=$!{bean.id}&action=person';" class="textCenter">$!message.date("DATE_TIME", $bean.begin) Uhr</td>
								#end

								#if($bean.end)
									#if ($bean.end.Seconds == 30)
										<td onclick="window.location.href='AddPersonToEventDetail?event-id=$!{bean.id}&action=person';" class="textCenter">$!message.date("DATE", $bean.end)</td>
									#else
										<td onclick="window.location.href='AddPersonToEventDetail?event-id=$!{bean.id}&action=person';" class="textCenter">$!message.date("DATE_TIME", $bean.end) Uhr</td>
									#end
								#else
									<td onclick="window.location.href='AddPersonToEventDetail?event-id=$!{bean.id}&action=person';" class="textCenter"></td>
								#end

								<td onclick="window.location.href='AddPersonToEventDetail?event-id=$!{bean.id}&action=person';">$!message.plain($bean.hostname)</td>
								<td onclick="window.location.href='AddPersonToEventDetail?event-id=$!{bean.id}&action=person';">
									#foreach($location in $allLocation)
										#if($location.get("id") == $bean.location)
											$!message.plain($location.get("name"))
										#end
									#end
								</td>

							#else
								#if($grants.mayWrite())
									<td class="textCenter"><input type="checkbox" name="${bean.id}-select" value="true" #if($listselection.indexOf($bean.id) != -1) checked#end></td>
								#end
								<td onclick="window.location.href='ShowEvent?id=$!{bean.id}';" class="textCenter"><input type="hidden" name="${bean.id}-id" value="$bean.id">$!{bean.id}</td>
								<td onclick="window.location.href='ShowEvent?id=$!{bean.id}';">$!message.plain($bean.shortname)</td>

								#if ($bean.begin.Seconds == 30)
									<td onclick="window.location.href='ShowEvent?id=$!{bean.id}';" class="textCenter">$!message.date("DATE", $bean.begin)</td>
								#else
									<td onclick="window.location.href='ShowEvent?id=$!{bean.id}';" class="textCenter">$!message.date("DATE_TIME", $bean.begin) Uhr</td>
								#end

								#if($bean.end)
									#if ($bean.end.Seconds == 30)
										<td onclick="window.location.href='ShowEvent?id=$!{bean.id}';" class="textCenter">$!message.date("DATE", $bean.end)</td>
									#else
										<td onclick="window.location.href='ShowEvent?id=$!{bean.id}';" class="textCenter">$!message.date("DATE_TIME", $bean.end) Uhr</td>
									#end
								#else
									<td onclick="window.location.href='ShowEvent?id=$!{bean.id}';" class="textCenter"></td>
								#end

								<td onclick="window.location.href='ShowEvent?id=$!{bean.id}';">$!message.plain($bean.hostname)</td>
								<td width="200px" onclick="window.location.href='ShowEvent?id=$!{bean.id}';">
									#foreach($location in $allLocation)
										#if($location.get("id") == $bean.location)
											$!message.plain($location.get("name"))
										#end
									#end
								</td>
								<td>
								##Vorbedingungen erfüllen
								</td>
							#end
						</tr>
					#end

					#set($itemName = "Veranstaltungen")
					#parse("inc/list-navi-new.vm")
					#parse("inc/list-direct-new.vm")

				</table>
		#end

		<div class="textRight">
			#if($action == "guest" && !$searchTask)
				<input type="button" name="cancel" value="${placeholderWithTranslation.zuruckzurveranstaltungssuche}" onclick="window.location.href='ShowGuestList?selectNone=true';" class="mainButton">
			#elseif($action == "addperson" || $searchTask)
				<input type="button" name="cancel" value="${placeholderWithTranslation.zuruckzurveranstaltungssuche}" onclick="window.location.href='ShowEventSearch';" class="mainButton">
			#end
		</div>
	</form>
</div>

<script>
	$(function() {
		$('#button\\.remove').click(function (e) {
			var checkBoxes = $('input:checkbox[name$="-select"]:checked');

			if (checkBoxes.length === 0) {
				showInfo(' ${placeholderWithTranslation.wahlensiebittezunachsteineodermehrereveranstaltungenaus} ');
			} else {
				$('form').append('<input type="hidden" name="remove" value="${placeholderWithTranslation.GENERIC_YES}" />').submit();
			}
		});

		$('#button\\.remove-cancel').click(function (e) {
			$('input[name$="-select"]').prop('checked', false);
			$('form').append('<input type="hidden" name="remove" value="${placeholderWithTranslation.GENERIC_YES}" />').submit();
		});
	});
</script>



#parse("inc/footer.vm")
