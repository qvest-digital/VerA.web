#set($activeMenu = "Veranstaltungen")
#set($title = "${placeholderWithTranslation.BROWSER_TITLE_EVENT_GUESTLIST}: $!message.plain($event.shortname)")
#set($elementNameSex = "${placeholderWithTranslation.GENDER_TYPE_GUEST}")
#set($elementNameSingular = "${placeholderWithTranslation.GENERIC_GUEST_SINGULAR}")
#set($elementNamePlural = "${placeholderWithTranslation.GENERIC_GUEST_PLURAL}")

##Values in per cent for table columns width
#set($column0 = 3)
#set($column1 = 8)
#set($column2 = 4)
#set($column3 = 20)
#set($column4 = 20)
#set($column5 = 20)
#set($column6 = 20)
#set($column7 = 13)
#set($column8 = 13)

#parse("inc/header.vm")

<div id="content_container">
	<div id="breadcrumb" class="textRight marginBottom10">
		<strong>${placeholderWithTranslation.siesindhier}:</strong> <span><a href="${paths.staticWeb}do/" title="Zur Startseite">${placeholderWithTranslation.home}</a> > ${placeholderWithTranslation.GENERIC_EVENT_PLURAL} > ${placeholderWithTranslation.veranstaltungbearbeiten}</span>
	</div>
	<h1>${placeholderWithTranslation.gasteverwaltungderveranstaltung}: $!message.plain($event.shortname)</h1>

	#if(!$isNewEvent)
		#set($completeEventHeader = true)
		#parse("inc/event-header.vm")
	#end

	#set($isUser = false)
	#set($isAdmin = false)
	#foreach($group in $octopusConfig.personalConfig.UserGroups)
		#if($group == "Writer")
			#set($isUser = true)
		#elseif($group == "PartialAdmin")
			#set($isAdmin = true)
		#elseif($group == "Administrator")
			#set($isAdmin = true)
		#end
	#end

	#if($invited)
		<vera-success>
			#if($invited == 0)
                ${placeholderWithTranslation.GUEST_LIST_DIDNT_CHANGE}.
			#elseif($invited == 1)
                ${placeholderWithTranslation.GUEST_LIST_EXPAND_ONE}.
			#else
                ${placeholderWithTranslation.GUEST_LIST_EXPAND_MULTIPLE_PART_ONE} $invited ${placeholderWithTranslation.GUEST_LIST_EXPAND_MULTIPLE_PART_TWO}.
			#end
		</vera-success>
	#end
	#if($mailinglistParams && $mailinglistParams.count)
		<vera-success>
			#if($mailinglistParams.count == 0)
             ${placeholderWithTranslation.GENERIC_DISTRIBUTOR_SINGULAR} &quot;$!message.plain($mailinglist.name)&quot; ${placeholderWithTranslation.GUEST_LIST_CREATED_NO_PERSON}.
			#elseif($mailinglistParams.count == 1)
                ${placeholderWithTranslation.GENERIC_DISTRIBUTOR_SINGULAR} &quot;$!message.plain($mailinglist.name)&quot; ${placeholderWithTranslation.GUEST_LIST_CREATED_ONE_PERSON}.
			#else
                ${placeholderWithTranslation.GENERIC_DISTRIBUTOR_SINGULAR} &quot;$!message.plain($mailinglist.name)&quot; ${placeholderWithTranslation.GUEST_LIST_CREATED_MULTIPLE_PERSON_PART_ONE} $!mailinglistParams.count ${placeholderWithTranslation.GUEST_LIST_CREATED_MULTIPLE_PERSON_PART_TWO}.
			#end
		</vera-success>
	#end

	#if($octopusRequest.task == "CalcSerialNumber" && (!$listquestions || $listquestions.size() == 0))
		<vera-success>
            ${placeholderWithTranslation..
		</vera-success>
	#end
	<div id="main_content" class="tabs contentBox marginBottom10 marginTop20 grayBorder" style="border-bottom:0">

		<div id="tabsMain">
			<ul vera-tab-group="" class="gray-gradient"> <!-- Bitte das End-tag der <li>s immer mit in die nächste Zeile nehmen (verhindert Mozilla styling bug) -->
				<li id="gaesteliste" vera-tab class="active posRel" style="z-index:2">
                    <div>${placeholderWithTranslation.G&auml;steliste</div>
				#if($list.size() > 0)
				</li>
                <li id="gastdetails" class="inactive">
                    <div>${placeholderWithTranslation.Gastdetails</div>
				</li>
                <li id="dokumenttypen" class="inactive">
                    <div>${placeholderWithTranslation.Dokumenttypen</div>
				#end
				</li>
			</ul>
		</div>

		<div style="border-bottom:1px solid #BDBDBD;" class="contentBoxColored tabsContent notBold posRel marginBottom40" vera-content="">

			<div id="guestSummary" class="table posAb hinweis grayBorder" style="padding-bottom: 5px;">
				<div class="tableRow">
					<div class="tableCell"><strong>${placeholderWithTranslation.Offen:</strong> $!guestlist-sums.offen</div>
					<div class="tableCell"><strong>${placeholderWithTranslation.Zusagen:</strong> $!guestlist-sums.zusagen</div>
					<div class="tableCell"><strong>${placeholderWithTranslation.Absagen:</strong> $!guestlist-sums.absagen</div>
					<div class="tableCell"><strong>${placeholderWithTranslation.Teilnahmen:</strong> $!guestlist-sums.teilnahmen</div>
					<div class="tableCell"><strong>${placeholderWithTranslation.Auf&nbsp;Platz:</strong> $!guestlist-sums.platz</div>
					<div class="tableCell"><strong>${placeholderWithTranslation.Auf&nbsp;Reserve:</strong> $!guestlist-sums.reserve</div>
				</div>
			</div>

			<form id="guestListFilter" name="guestListFilter" action="ShowGuestList" method="POST" class="marginTop25">
				<input type="hidden" name="start" value="0">
				<input type="hidden" name="limit" value="" />
				<input type="hidden" name="selectAll" value="false">
				<input type="hidden" name="selectNone" value="true">
				<input type="hidden" name="search-event" value="$search.event">
				<input type="hidden" id="search-listorder" name="search-listorder" value="$!search.listorder">

				<h3 class="marginBottom0">${placeholderWithTranslation.Filter</h3>

				<div class="table width75">
					<div class="tableRow">
						<div class="tableCell width25">
							<label for="search-reserve">${placeholderWithTranslation.Platzwahl</label>
							<select name="search-reserve" id="search-reserve" onchange="submit();">
										<option value="">${placeholderWithTranslation.Alle G&auml;ste</option>
										<option #if($search.reserve && $search.reserve == 1) selected#end value="1">${placeholderWithTranslation.Alle G&auml;ste auf Platz</option>
										<option #if($search.reserve && $search.reserve == 2) selected#end value="2">${placeholderWithTranslation.Alle G&auml;ste auf Reserve</option>
							</select>
						</div>
						<div class="tableCell width25">
							<label for="search-invitationstatus">${placeholderWithTranslation.Status</label>
							<select name="search-invitationstatus" id="search-invitationstatus" onchange="submit();">
								<option value="">${placeholderWithTranslation.Alle</option>
								<option #if($search.invitationstatus && $search.invitationstatus == 1) selected#end value="1">${placeholderWithTranslation.nur Offene</option>
								<option #if($search.invitationstatus && $search.invitationstatus == 2) selected#end value="2">${placeholderWithTranslation.nur Zusagen</option>
								<option #if($search.invitationstatus && $search.invitationstatus == 3) selected#end value="3">${placeholderWithTranslation.nur Absagen</option>
								<option #if($search.invitationstatus && $search.invitationstatus == 4) selected#end value="4">${placeholderWithTranslation.nur Teilnahmen</option>
							</select>
						</div>
						<div class="tableCell width50">
							<label for="search-category">${placeholderWithTranslation.Kategorie</label>
							<select name="search-category" id="search-category" onchange="submit();">
								<option value="">${placeholderWithTranslation.Alle</option>
								#foreach($category in $categories)
									<option #if($search.category && $search.category == $category) selected#end value="$category">$category</option>
								#end
							</select>
						</div>
					</div>
				</div>

			</form>

			#if($listerrors.size() > 0)
				<vera-warn>
					#foreach($error in $listerrors)
						$error<br>
					#end
				</vera-warn>
			#elseif($listquestions && $listquestions.size() > 0)
				<form action="" method="POST">
				<div style="margin: 10px 0px 10px 0px; padding: 10px 10px 10px 10px; background-color: #ffffff; border: 2px solid #00ff00;">
					<strong>${placeholderWithTranslation.Bitte best&auml;tigen Sie die folgende Aktion</strong><br>
					<table class="form" style="margin: 5px 0px 0px 0px;">
					#foreach($quest in $listquestions.entrySet())
						<tr>
							<td><input type="hidden" name="$quest.key" value="true">$quest.value</td>
						</tr>
						#set($save = true)
					#end
					</table><br>

					#if($save)
						<input type="submit" name="remove" value="Ja" title="Speichern" />
					#end

					<input type="button" name="cancel" value="Nein" title="Abbrechen" onclick="window.location.href='ShowGuestList?selectNone=true';"> &nbsp;
				</div>
				</form>
			#end

			<form id="formlist" name="formlist" action="ShowGuestList" method="POST">
			<input type="hidden" name="start" value="">
			<input type="hidden" name="limit" value="" />
			<input type="hidden" name="selectNone" id="selectNone" value="true">
			<input type="hidden" name="doInsert" value="false">
			<input type="hidden" name="doUpdate" value="true">
			<input type="hidden" name="doRemove" value="true">
			<input type="hidden" name="categoryAssignmentAction" value="">
			<input type="hidden" name="categoryAssignmentId" value="">
			<input type="hidden" name="workareaAssignmentAction" value="">
			<input type="hidden" name="workareaAssignmentId" value="">

			#foreach($bean in $list)
				<input type="hidden" name="list" value="$bean.id">
			#end

			<!-- neu -->
			<div class="table width100 marginTop30">
				<div class="tableRow">
						<div class="tableCell width35 inlineInput" style="padding-bottom:0"><label for="actionSelection">${placeholderWithTranslation.Markierte Person(en)</label>
								<select id="actionSelection" class="autoWidth">
									<option>${placeholderWithTranslation.Löschen</option>
									<option>${placeholderWithTranslation.Kategorien zuordnen</option>
									<option>${placeholderWithTranslation.Kategorien entfernen</option>
									<option>${placeholderWithTranslation.Verteiler erstellen</option>
									<option>${placeholderWithTranslation.Steuerdatei exportieren</option>
								</select>
								<input type="button" name="button.execute" id="button.execute" value="${placeholderWithTranslation.durchfuhren}" class="autoWidth">
						</div>
						<div class="tableCell textRight" style="vertical-align:bottom; padding-bottom:0">
							#if($grants.mayWrite())
								<input type="button" class="mainButton inlineInput autoWidth" name="createGuestList" value="${placeholderWithTranslation.G&auml;steliste erstellen" title="${placeholderWithTranslation.G&auml;steliste erstellen" onclick="submitFormWithGivenAction('ShowReportGuestList', $grants.mayWrite());" />
								<input type="button" class="mainButton inlineInput autoWidth" name="addGuestsFromEvent" value="${placeholderWithTranslation.G&auml;ste aus Veranstaltung &uuml;bernehmen" title="${placeholderWithTranslation.G&auml;ste aus Veranstaltung &uuml;bernehmen" onclick="window.location.href='AddEventToEventSearch?action=guest';" />
								<input type="button" class="mainButton inlineInput autoWidth" name="add" value="${placeholderWithTranslation.Gast hinzuf&uuml;gen" title="${placeholderWithTranslation.Personen suchen und zu der G&auml;steliste hinzuf&uuml;gen" onclick="window.location.href='AddPersonToEventSearch?action=guest&search=clear';" />
							#end
						</div>
				</div>
			</div><!--neu -->

			## Handler für selektierte Aktion
			<script>
				var removeGuestabfrage = function () {
						#if(!$grants.mayWrite())
							showWarning('Sie haben keine ausreichende Berechtigung um G&auml;ste zu entfernen.');
							return;
						#end
						var checkBoxes = $('input:checkbox[name$="-select"]:checked');
						if (checkBoxes.length === 0) {
							$(".errormsg").remove();
							$(".successmsg").remove();
							showWarning('W&auml;hlen Sie bitte zun&auml;chst eine oder mehrere G&auml;ste aus.');
						} else {
							$(".errormsg").remove();
							$(".successmsg").remove();
							var msg = '';
							msg += '<br><span class="notBold">Wenn Sie Ihre Auswahl anpassen wollen, brechen Sie bitte das L&ouml;schen ab.</span><br>'+ 'Sollen alle markierten Personen gel&ouml;scht werden? ' +
							'Diese Aktion kann nicht r&uuml;ckg&auml;ngig gemacht werden.<br>';
							// disable all checkboxes while confirmation is visible
							$('input:checkbox').prop('disabled', true);
							showConfirmYesNo('Bitte best&auml;tigen Sie das L&ouml;schen der markierten G&auml;ste!',
								msg,
								function () { // Ja
									$('<input>').attr({ type: 'hidden', id: 'remove', name: 'remove' }).appendTo($('#formlist'));
									$('input:checkbox').prop('disabled', false);
									document.formlist.submit();

								}, function () { // Nein
									$(".errormsg").remove();
									$(".successmsg").remove();
									showSuccess('Es wurden keine G&auml;ste gel&ouml;scht.');
									$('input:checkbox').prop('disabled', false);

								});
						}
				}


				$(function () {

					$('#button\\.execute').click(function (e) {
						var selectText = $('#actionSelection option:selected').text();

						if(hasSelection()){
							if (selectText == "Löschen") {
								removeGuestabfrage();
							} else if (selectText == "Kategorien zuordnen") {
								assignCategories();
							} else if (selectText == "Kategorien entfernen") {
								unassignCategories();
							} else if (selectText == "Verteiler erstellen") {
								$('#selectNone').val('false');
								submitFormWithGivenAction('CreateMailinglist', $grants.mayWrite());
							} else if (selectText == "Steuerdatei exportieren") {
								$('#selectNone').val('false');
								submitFormWithGivenAction('ShowExportGuestDoctype', $grants.mayExport());
							}
						} else {
							$(".errormsg").remove();
							$(".successmsg").remove();
							showWarning( "Wählen Sie bitte zunächst einen oder mehrere G&auml;ste aus." );
						}
					});
				});



				var selectedCount = ${listselection.size()};

				function hasSelection() {
					return $('input:checked[name$="-select"]').length > 0;
				}

				function selectionChange( elt ) {
					selectedCount += ( elt.checked ? 1 : -1 );
				}

				function selectedActionRemoveGuest() {
					$('<input>').attr({ type: 'hidden', id: 'remove', name: 'remove' }).appendTo($('#formlist'));
					document.formlist.submit();
				}

				function unassignCategories() {
					selectPersonCategory( "${paths.staticWeb}do/popupUnassignGuestCategory?count=" + selectedCount + "&eventId=" + ${event.id} );
				}

				function assignCategories() {
					selectPersonCategory( "${paths.staticWeb}do/popupAssignGuestCategory?count=" + selectedCount + "&eventId=" + ${event.id} );
				}

				function submitFormWithGivenAction(action, permission) {
						htmlWait();
						document.getElementById('formlist').action = action;
						document.formlist.submit();
				}
			</script>

			<table class="sortable">
				##Set column size
				<col width="$column0%" />
   				<col width="$column1%" />
   				<col width="$column2%" />
   				<col width="$column3%" />
   				<col width="$column4%" />
   				<col width="$column5%" />
   				<col width="$column6%" />
   				<col width="$column7%" />
   				<col width="$column8%" />

				<tr>
					<th class="textCenter smallCell"><input type="checkbox" name="toggleAllSelect" id="toggleAllSelect" title="${placeholderWithTranslation.Alle (de)markieren" #if($listselection.size() == $list.size()) checked#end/></th>
			#if($search.listorder == "lastname_a_e1")
					<th class="textCenter smallCell"><a href="javascript:orderGuestList('orderno');"><nobr>${placeholderWithTranslation.Lfd.-Nr.</nobr></a></th>
					<th class="textCenter smallCell" title="${placeholderWithTranslation.Auf Reserve / Platz"><span style="display: inline-block; padding: 10px;color: #1B1B1B;">${placeholderWithTranslation.R</span></th>
					<th><a href="javascript:orderGuestList('companyname');"><nobr>${placeholderWithTranslation.Firma</nobr></a></th>
					<th><a href="javascript:orderGuestList('lastname_a_e1');" style="color: #000000;">${placeholderWithTranslation.GENERIC_NAME}</a></th>
					<th><a href="javascript:orderGuestList('firstname_a_e1');">${placeholderWithTranslation.Vorname</a></th>
					<th class="textCenter smallCell" style="width:10%"><a href="javascript:orderGuestList('mail_a_e1');">${placeholderWithTranslation.E-Mail</a></th>
			#elseif($search.listorder == "firstname_a_e1")
					<th class="textCenter smallCell"><a href="javascript:orderGuestList('orderno');"><nobr>${placeholderWithTranslation.Lfd.-Nr.</nobr></a></th>
					<th class="textCenter smallCell" title="Auf Reserve / Platz"><span style="display: inline-block; padding: 10px;color: #1B1B1B;">${placeholderWithTranslation.R</span></th>
					<th><a href="javascript:orderGuestList('companyname');"><nobr>${placeholderWithTranslation.Firma</nobr></a></th>
					<th><a href="javascript:orderGuestList('lastname_a_e1');">${placeholderWithTranslation.GENERIC_NAME}</a></th>
					<th><a href="javascript:orderGuestList('firstname_a_e1');" style="color: #000000;">${placeholderWithTranslation.Vorname</a></th>
					<th class="textCenter smallCell" style="width:10%"><a href="javascript:orderGuestList('mail_a_e1');">${placeholderWithTranslation.E-Mail</a></th>
			#elseif($search.listorder == "mail_a_e1")
					<th class="textCenter smallCell"><a href="javascript:orderGuestList('orderno');"><nobr>${placeholderWithTranslation.Lfd.-Nr.</nobr></a></th>
					<th class="textCenter smallCell" title="Auf Reserve / Platz"><span style="display: inline-block; padding: 10px;color: #1B1B1B;">${placeholderWithTranslation.R</span></th>
					<th><a href="javascript:orderGuestList('companyname');"><nobr>${placeholderWithTranslation.Firma</nobr></a></th>
					<th><a href="javascript:orderGuestList('lastname_a_e1');">${placeholderWithTranslation.GENERIC_NAME}</a></th>
					<th><a href="javascript:orderGuestList('firstname_a_e1');">${placeholderWithTranslation.Vorname</a></th>
					<th class="textCenter smallCell" style="width:10%"><a href="javascript:orderGuestList('mail_a_e1');" style="color: #000000;">${placeholderWithTranslation.E-Mail</a></th>
			#elseif($search.listorder == "companyname")
					<th class="textCenter smallCell"><a href="javascript:orderGuestList('orderno');"><nobr>${placeholderWithTranslation.Lfd.-Nr.</nobr></a></th>
					<th class="textCenter smallCell" title="Auf Reserve / Platz"><span style="display: inline-block; padding: 10px;color: #1B1B1B;">${placeholderWithTranslation.R</span></th>
					<th><a href="javascript:orderGuestList('companyname');" style="color: #000000;"><nobr>${placeholderWithTranslation.Firma</nobr></a></th>
					<th><a href="javascript:orderGuestList('lastname_a_e1');">${placeholderWithTranslation.GENERIC_NAME}</a></th>
					<th><a href="javascript:orderGuestList('firstname_a_e1');">${placeholderWithTranslation.Vorname</a></th>
					<th class="textCenter smallCell" style="width:10%"><a href="javascript:orderGuestList('mail_a_e1');">${placeholderWithTranslation.E-Mail</a></th>

			#elseif($search.listorder == "orderno")
					<th class="textCenter smallCell"><a href="javascript:orderGuestList('orderno');" style="color: #000000;"><nobr>${placeholderWithTranslation.Lfd.-Nr.</nobr></a></th>
					<th class="textCenter smallCell" title="Auf Reserve / Platz"><span style="display: inline-block; padding: 10px;color: #1B1B1B;">${placeholderWithTranslation.R</span></th>
					<th><a href="javascript:orderGuestList('companyname');"><nobr>${placeholderWithTranslation.Firma</nobr></a></th>
					<th><a href="javascript:orderGuestList('lastname_a_e1');">${placeholderWithTranslation.GENERIC_NAME}</a></th>
					<th><a href="javascript:orderGuestList('firstname_a_e1');">${placeholderWithTranslation.Vorname</a></th>
					<th class="textCenter smallCell" style="width:10%"><a href="javascript:orderGuestList('mail_a_e1');">${placeholderWithTranslation.E-Mail</a></th>
			#else
					<th class="textCenter smallCell"><a href="javascript:orderGuestList('orderno');" style="color: #000000;"><nobr>${placeholderWithTranslation.Lfd.-Nr.</nobr></a></th>
					<th class="textCenter smallCell" title="Auf Reserve / Platz"><span style="display: inline-block; padding: 10px;color: #1B1B1B;">${placeholderWithTranslation.R</span></th>
					<th><a href="javascript:orderGuestList('companyname');" style="color: #000000;"><nobr>${placeholderWithTranslation.Firma</nobr></a></th>
					<th><a href="javascript:orderGuestList('lastname_a_e1');">${placeholderWithTranslation.GENERIC_NAME}</a></th>
					<th><a href="javascript:orderGuestList('firstname_a_e1');">${placeholderWithTranslation.Vorname</a></th>
					<th class="textCenter smallCell" style="width:10%"><a href="javascript:orderGuestList('mail_a_e1');">${placeholderWithTranslation.E-Mail</a></th>
			#end

			#if($userConfig.guestListFunction)
					<th style="padding: 10px">${placeholderWithTranslation.Funktion</th>
			#end

			#if($userConfig.guestListCity)
					<th style="padding: 10px">${placeholderWithTranslation.PLZ / ${placeholderWithTranslation.Ort</th>
			#end

			#if($userConfig.guestListPhone)
					<th style="padding: 10px">${placeholderWithTranslation.Telefon</th>
			#end
					<th style="width: 100px; text-align: center;"><span style="display: inline-block; padding: 10px;color: #1B1B1B;">$!message.text($!config.main)</span></th>
					<th style="width: 100px; text-align: center;"><span style="display: inline-block; padding: 10px;color: #1B1B1B;">$!message.text($!config.partner)</span></th>
				</tr>

				#set($deletedperson = false)

				#foreach($bean in $list)
					#if ($bean.deleted == "t")
						#set($deletedperson = true)
					#end

				#set($offset = $listparam.start + $velocityCount)

				<tr>
					<td><input type="hidden" id="${bean.id}-modified" name="${bean.id}-modified" value="false"><input type="hidden" id="${bean.id}-invitationtype" name="${bean.id}-invitationtype" value="${bean.invitationtype}"><input type="checkbox" name="${bean.id}-select" onChange="selectionChange( this );" value="true" #if($listselection.indexOf($bean.id) != -1) checked#end/></td>
					<td style="cursor: pointer;" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&eventId=${event.id}&offset=$offset';"><input type="hidden" name="${bean.id}-id" value="$bean.id">
						#if($bean.ishost && $bean.ishost == 1)
							<em>${placeholderWithTranslation.Gastgeber</em>
						#elseif($bean.someorderno)
							$bean.someorderno
						#else
							<em>${placeholderWithTranslation.keine</em>
						#end
					</td>

					#if($bean.reserve == 1)
						<td class="textCenter" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&eventId=${event.id}&offset=$offset';" title="${placeholderWithTranslation.Auf Reserve"><strong>${placeholderWithTranslation.R</strong></td>
					#else
						<td class="textCenter" onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&eventId=${event.id}&offset=$offset';" title="${placeholderWithTranslation.Auf Platz">&nbsp;</td>
					#end

					#if($bean.company_a_e1 != "")
						<td onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&eventId=${event.id}&offset=$offset';" title="${placeholderWithTranslation.Firma/Institution">$bean.company_a_e1</td>
					#else
						<td onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&eventId=${event.id}&offset=$offset';" title="${placeholderWithTranslation.Firma/Institution">&nbsp;</td>
					#end

					#if($bean.iscompany == "t" && $bean.delegation != "" && $bean.invitationtype != 4)
						<td></td>
						<td></td>
						<td></td>
						#if($userConfig.guestListFunction)
							<td></td>
						#end

						#if($userConfig.guestListCity)
							<td></td>
						#end

						#if($userConfig.guestListPhone)
							<td></td>
						#end
						<td></td>
						<td></td>
					#else
						<td onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&eventId=${event.id}&offset=$offset';">
							#if($bean.invitationtype != 3)
								#if($bean.showdoctype)
									$!message.plain($bean.lastname_a_gd)
								#else
									$!message.plain($bean.lastname_a_e1)
								#end
							#else
								#if($bean.showdoctype)
									$!message.plain($bean.lastname_b_gd)
								#else
									$!message.plain($bean.lastname_b_e1)
								#end
							#end
						</td>
						<td onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&eventId=${event.id}&offset=$offset';">
							#if($bean.invitationtype != 3)
								#if($bean.showdoctype)$!message.plain($bean.firstname_a_gd)#else$!message.plain($bean.firstname_a_e1)#end
							#else
								#if($bean.showdoctype)$!message.plain($bean.firstname_b_gd)#else$!message.plain($bean.firstname_b_e1)#end
							#end
						</td>
						<td class="textCenter">
							<div class="cutOff">
								#if($bean.showdoctype)
									#if($bean.mail_a_gd.length() > 0)
										<a href="mailto:$!message.plain($bean.mail_a_gd)" title="$!message.plain($bean.mail_a_gd)">$!message.plain($bean.mail_a_gd)</a>
									#else
										&nbsp;
									#end
								#else
									#if($bean.mail_a_e1.length() > 0)
										<a href="mailto:$!message.plain($bean.mail_a_e1)" title="$!message.plain($bean.mail_a_e1)">$!message.plain($bean.mail_a_e1)</a>
									#else
										&nbsp;
									#end
								#end
							</div>
						</td>
						#if($userConfig.guestListFunction)
							<td onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&eventId=${event.id}&offset=$offset';">#if($bean.showdoctype)$!message.plain($bean.function_a_gd)#else$!message.plain($bean.function_a_e1)#end</td>
						#end
						#if($userConfig.guestListCity)
							<td onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&eventId=${event.id}&offset=$offset';">#if($bean.showdoctype)$!message.plain($bean.zipcode_a_gd) $!message.plain($bean.city_a_gd)#else$!message.plain($bean.zipcode_a_e1) $!message.plain($bean.city_a_e1)#end</td>
						#end
						#if($userConfig.guestListPhone)
							<td onclick="window.location.href='ShowGuestDetail?id=$!{bean.id}&eventId=${event.id}&offset=$offset';">#if($bean.showdoctype)$!message.plain($bean.fon_a_gd)#else$!message.plain($bean.fon_a_e1)#end</td>
						#end
						<td class="textCenter">
							#if($bean.invitationtype != 3)
								#if($grants.mayWrite())
								<select name="${bean.id}-invitationstatus_a" onchange="setModified('${bean.id}')">
									<option #if($bean.invitationstatus_a && $bean.invitationstatus_a == 0) selected#end value="0">${placeholderWithTranslation.Offen</option>
									<option #if($bean.invitationstatus_a && $bean.invitationstatus_a == 1) selected#end value="1">${placeholderWithTranslation.Zusage</option>
									<option #if($bean.invitationstatus_a && $bean.invitationstatus_a == 2) selected#end value="2">${placeholderWithTranslation.Absage</option>
									<option #if($bean.invitationstatus_a && $bean.invitationstatus_a == 3) selected#end value="3">${placeholderWithTranslation.Teilgenommen</option>
								</select>
								#else
									#if($bean.invitationstatus_a && $bean.invitationstatus_a == 0)
                                        ${placeholderWithTranslation.Offen
									#elseif($bean.invitationstatus_a && $bean.invitationstatus_a == 1)
                                        ${placeholderWithTranslation.Zusage
									#elseif($bean.invitationstatus_a && $bean.invitationstatus_a == 2)
                                        ${placeholderWithTranslation.Absage
									#elseif($bean.invitationstatus_a && $bean.invitationstatus_a == 3)
                                        ${placeholderWithTranslation.Teilgenommen
									#end
								#end
							#else
								<input type="hidden" name="${bean.id}-invitationstatus_a" value="$!bean.invitationstatus_a">nicht eingeladen
							#end
						</td>

						<td class="textCenter">
							#if($bean.invitationtype != 2)
								#if($grants.mayWrite())
									<select name="${bean.id}-invitationstatus_b" onchange="setModified('${bean.id}')">
										<option #if($bean.invitationstatus_b && $bean.invitationstatus_b == 0) selected#end value="0">${placeholderWithTranslation.Offen</option>
										<option #if($bean.invitationstatus_b && $bean.invitationstatus_b == 1) selected#end value="1">${placeholderWithTranslation.Zusage</option>
										<option #if($bean.invitationstatus_b && $bean.invitationstatus_b == 2) selected#end value="2">${placeholderWithTranslation.Absage</option>
										<option #if($bean.invitationstatus_a && $bean.invitationstatus_b == 3) selected#end value="3">${placeholderWithTranslation.Teilgenommen</option>
									</select>
								#else
									#if($bean.invitationstatus_b && $bean.invitationstatus_b == 0)
                                        ${placeholderWithTranslation.Offen
									#elseif($bean.invitationstatus_b && $bean.invitationstatus_b == 1)
                                        ${placeholderWithTranslation.Zusage
									#elseif($bean.invitationstatus_b && $bean.invitationstatus_b == 2)
                                        ${placeholderWithTranslation.Absage
									#elseif($bean.invitationstatus_b && $bean.invitationstatus_b == 3)
                                        ${placeholderWithTranslation.Teilgenommen
									#end
								#end
							#else
								<input type="hidden" name="${bean.id}-invitationstatus_b" value="$!bean.invitationstatus_b">${placeholderWithTranslation.nicht eingeladen</input>
							#end
						</td>
					#end
				</tr>
				#end

				#if ($listparam.count == 0)
					<tr class="colspan"><td colspan="99">${placeholderWithTranslation.Es wurden noch keine Gäste eingeladen</td></tr>
				#end

				#set($itemName = "${placeholderWithTranslation.GENERIC_GUEST_PLURAL}")
				#parse("inc/list-navi-new.vm")

				#if($search.listorder)
					#parse("inc/list-direct-new.vm")
				#else
					<tr class="colspan">
						<td colspan="99" class="textCenter">
							<strong>${placeholderWithTranslation.GENERIC_TOOLTIP}:</strong> ${placeholderWithTranslation.HINT_ENTRY_POINT}
						</td>
					</tr>
				#end

			</table>

			<div class="textRight marginTop10 marginBottom20">
				<input type="button" name="calcSerialNumber" value="Laufende Nummer berechnen" title="Laufende Nummer berechnen" onclick="htmlWait(); window.location.href='CalcSerialNumber';" #if(!$grants.mayWrite()) class="buttondisabled" vera-disabled #end>
				<input type="button" name="reloadAllGuestData" value="Alle Stammdaten neu laden" title="Alle Stammdaten neu laden" onclick="submitFormWithGivenAction('ReloadAllGuestData', $grants.mayWrite());" #if(!$grants.mayWrite()) class="buttondisabled" vera-disabled #end>
			</div>

			<vera-info vera-stay>
                ${placeholderWithTranslation.Beim Erstellen von Steuerdateien oder G&auml;stelisten wird Ihr oben ausgew&auml;hlter Filter ber&uuml;cksichtigt.<br>
                ${placeholderWithTranslation.Wenn Sie einzelne G&auml;ste markieren, werden nur diese exportiert, ansonsten die vollst&auml;ndige Liste.
			</vera-info>

			#if($deletedperson)
				<table>
					<tr style="height: 20px;">
						<td class="list2error" style="width: 20px;">&nbsp;</td>
						<td class="list1error">
                            ${placeholderWithTranslation.Rot hinterlegte Personen wurden bereits als &quot;zu l&ouml;schen&quot; markiert.
						</td>
					</tr>
				</table>
				<br>
			#end

			<div>



			#set($isUser = false)
			#set($isAdmin = false)

			#foreach($group in $octopusConfig.personalConfig.UserGroups)
				#if($group == "Writer")
					#set($isUser = true)
				#elseif($group == "PartialAdmin")
					#set($isAdmin = true)
				#elseif($group == "Administrator")
					#set($isAdmin = true)
				#end
			#end

			</div>

			<div style="bottom: -40px; right: -1px;" class="textRight posAb" id="buttonPanel-bottom">
				#if($grants.mayWrite())
					<input type="submit" name="save" value="${placeholderWithTranslation.Speichern" title="${placeholderWithTranslation.Speichern" class="mainButton" />
				#end
				<input type="button" name="cancel" value="${placeholderWithTranslation.Zur&uuml;ck zu den Veranstaltungsdetails" title="${placeholderWithTranslation.Zur&uuml;ck zu den Veranstaltungsdetails" class="mainButton" onclick="window.location.href='ShowEvent?id=$!event.id&action=event';" />
			</div>

			</form>
		</div>
	</div>

</div>


<script type="text/javascript">
	function orderGuestList(column) {
		document.getElementById('search-listorder').value = column;
		document.getElementById('guestListFilter').submit();
	}

	#if($invited && $invited == 0 && $notInvited && $notInvited == 0 && ! $doNotAlert)
		showWarning('Sie haben keine Person ausgewählt.');
	#elseif($notInvited)
		#if($notInvited == 1)
			showWarning('Ein Gast stand bereits auf der Gästeliste.');
		#elseif($notInvited > 1)
			showWarning('$!notInvited Gäste standen bereits auf der Gästeliste.');
		#end
	#end

	$(function () {
		$('li#gastdetails').click(function () {
			window.location.href = '${paths.staticWeb}do/ShowGuestDetail';
		});
		$('li#dokumenttypen').click(function () {
			window.location.href = '${paths.staticWeb}do/ShowGuestDoctype';
		});
	});

</script>

#parse("inc/footer.vm")
